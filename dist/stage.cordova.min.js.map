{"version":3,"sources":["webpack://Stage/webpack/bootstrap","webpack://Stage/./lib/core.js","webpack://Stage/./lib/util/create.js","webpack://Stage/./lib/pin.js","webpack://Stage/./lib/loop.js","webpack://Stage/./lib/util/stats.js","webpack://Stage/./lib/util/extend.js","webpack://Stage/./lib/util/is.js","webpack://Stage/./lib/texture.js","webpack://Stage/./lib/util/math.js","webpack://Stage/./lib/matrix.js","webpack://Stage/./lib/index.js","webpack://Stage/./lib/util/await.js","webpack://Stage/./lib/atlas.js","webpack://Stage/./lib/util/string.js","webpack://Stage/./lib/tree.js","webpack://Stage/./lib/event.js","webpack://Stage/./lib/util/event.js","webpack://Stage/./lib/root.js","webpack://Stage/./lib/canvas.js","webpack://Stage/./lib/image.js","webpack://Stage/./lib/util/repeat.js","webpack://Stage/./lib/anim.js","webpack://Stage/./lib/str.js","webpack://Stage/./lib/layout.js","webpack://Stage/./lib/addon/tween.js","webpack://Stage/./lib/addon/easing.js","webpack://Stage/./lib/addon/mouse.js","webpack://Stage/./platform/cordova.js","webpack://Stage/./lib/loader/cordova.js","webpack://Stage/./lib/util/once.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","stats","extend","is","_await","Class","arg","this","fn","app","apply","arguments","atlas","_init","length","push","_load","_config","config","string","_app_queue","_stages","_loaded","_paused","opts","loader","stage","canvas","start","loading","preload","load","url","resolve","test","callback","src","el","document","createElement","addEventListener","err","id","Date","now","body","appendChild","loadScript","then","args","shift","pause","resume","window","scripts","getElementsByTagName","currentScript","stack","Error","split","match","readyState","location","href","getScriptSrc","substring","lastIndexOf","proto","props","noop","Matrix","iid","Pin","owner","_owner","_parent","_relativeMatrix","_absoluteMatrix","reset","_pin","matrix","relative","relativeMatrix","absoluteMatrix","pin","a","b","set","_textureAlpha","_alpha","_width","_height","_scaleX","_scaleY","_skewX","_skewY","_rotation","_pivoted","_pivotX","_pivotY","_handled","_handleX","_handleY","_aligned","_alignX","_alignY","_offsetX","_offsetY","_boxX","_boxY","_boxWidth","_boxHeight","_ts_translate","_ts_transform","_ts_matrix","_update","_mo_handle","_mo_align","toString","ts","Math","max","_mo_abs","abs","concat","_mo_rel","q","rel","identity","translate","scale","skew","rotate","_x","_y","getters","setters","_ts_pin","touch","alpha","textureAlpha","width","height","boxWidth","boxHeight","scaleX","scaleY","skewX","skewY","rotation","pivotX","pivotY","offsetX","offsetY","alignX","alignY","handleX","handleY","_width_","_height_","pivot","offset","align","handle","resizeMode","all","scaleTo","resizeWidth","resizeHeight","scaleMode","scaleWidth","scaleHeight","e","f","w","h","min","y","x","_add_shortcuts","size","ta","_textures","render","context","_visible","node","setTransform","globalAlpha","draw","child","next","_first","_next","_tickBefore","_tickAfter","MAX_ELAPSE","Infinity","_tick","elapsed","last","ticked","tick","_flag","ticker","before","untick","indexOf","splice","timeout","time","setTimeout","timer","clearTimeout","base","obj","objProto","owns","toStr","hexRegex","an","type","defined","empty","equal","other","getTime","instance","constructor","nil","undef","array","emptyarray","arraylike","boolean","isFinite","number","element","undefined","HTMLElement","nodeType","nan","hash","setInterval","regexp","hex","math","Texture","image","ratio","pipe","_image","_sx","_dx","_sy","_dy","_sw","_dw","_sh","_dh","dest","x1","y1","x2","y2","x3","y3","x4","y4","sx","sy","sw","sh","dx","dy","dw","dh","limit","drawImage","ex","_draw_failed","console","log","native","random","num","sqrt","clone","_dirty","angle","u","cos","v","sin","inverse","reverse","inversed","z","map","mapX","mapY","count","fork","_atlases_map","_atlases_arr","Atlas","def","_super","deprecated","filter","ppu","trim","textures","factory","cutouts","sprites","make","top","bottom","left","right","texture","find","query","result","startsWith","subquery","select","Selection","found","imagePath","imageRatio","done","imageloader","nfTexture","nfSelection","link","one","arr","msg","replace","slice","error","str","sub","append","parent","_ensure","remove","_last","_prev","_ts_parent","_ts_children","prepend","insertBefore","self","prev","insertAfter","_label","_attrs","_flags","label","attr","visible","hide","show","first","visit","visitor","data","end","more","appendTo","prependTo","insertNext","sibling","insertPrev","_ts_touch","hitTest","hit","on","_listeners","listen","types","listener","join","off","index","listeners","publish","trigger","Root","request","paused","stopped","lastTime","loop","_mo_touch","fps","touch_root","stop","root","background","color","viewport","_viewport","viewbox","_viewbox","box","attributes","drawFn","getContext","repeat","Image","img","setImage","tile","inner","_repeat","stretch","insert","_repeatTicker","_mo_stretch","owidth","oheight","Anim","_fps","FPS","_ft","_time","_index","_frames","ignore","moveFrame","_callback","anim","frames","gotoFrame","setFrames","frame","resize","move","play","Str","setFont","_item","setValue","_value","_spacing","row","sequence","column","_padding","_layoutTiker","_mo_seq","alignChildren","_mo_seqAlign","_mo_box","layer","padding","pad","spacing","space","Easing","Tween","duration","delay","_end","_duration","_delay","pinning","tween","_tweens","ticktime","head","Array","isArray","unshift","over","_start","_easing","actions","_hide","_remove","_done","ease","easing","clear","forward","_identity","_cache","_modes","_easings","token","exec","params","fc","add","names","PI","pow","asin","Mouse","elem","locate","event","ev","loc","touches","clientX","clientY","rect","getBoundingClientRect","clientLeft","clientTop","locateElevent","lookup","collect","targets","timeStamp","mouse","raw","cancel","subscribe","CLICK","START","MOVE","END","CANCEL","handleStart","handleEnd","handleMove","handleCancel","clicklist","cancellist","preventDefault","defineValue","internal","_extend","_create","once","FastContext","_supported","configs","full","getElementById","style","position","firstChild","fastcontext","isFast","devicePixelRatio","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","requestAnimationFrame","msRequestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","oRequestAnimationFrame","clearRect","innerWidth","screen","innerHeight","clientWidth","clientHeight","setBackgroundColor","backgroundColor","success","createImage","loaded","onload","onerror","ctx","called"],"mappings":"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","file":"stage.cordova.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 29);\n","if (typeof DEBUG === 'undefined')\n  DEBUG = true;\n\nvar stats = require('./util/stats');\nvar extend = require('./util/extend');\nvar is = require('./util/is');\nvar _await = require('./util/await');\n\nstats.create = 0;\n\nfunction Class(arg) {\n  if (!(this instanceof Class)) {\n    if (is.fn(arg)) {\n      return Class.app.apply(Class, arguments);\n    } else if (is.object(arg)) {\n      return Class.atlas.apply(Class, arguments);\n    } else {\n      return arg;\n    }\n  }\n\n  stats.create++;\n\n  for (var i = 0; i < _init.length; i++) {\n    _init[i].call(this);\n  }\n}\n\nvar _init = [];\n\nClass._init = function(fn) {\n  _init.push(fn);\n};\n\nvar _load = [];\n\nClass._load = function(fn) {\n  _load.push(fn);\n};\n\nvar _config = {};\n\nClass.config = function() {\n  if (arguments.length === 1 && is.string(arguments[0])) {\n    return _config[arguments[0]];\n  }\n  if (arguments.length === 1 && is.object(arguments[0])) {\n    extend(_config, arguments[0]);\n  }\n  if (arguments.length === 2 && is.string(arguments[0])) {\n    _config[arguments[0], arguments[1]];\n  }\n};\n\nvar _app_queue = [];\nvar _preload_queue = [];\nvar _stages = [];\nvar _loaded = false;\nvar _paused = false;\n\nClass.app = function(app, opts) {\n  if (!_loaded) {\n    _app_queue.push(arguments);\n    return;\n  }\n  DEBUG && console.log('Creating app...');\n  var loader = Class.config('app-loader');\n  loader(function(stage, canvas) {\n    DEBUG && console.log('Initing app...');\n    for (var i = 0; i < _load.length; i++) {\n      _load[i].call(this, stage, canvas);\n    }\n    app(stage, canvas);\n    _stages.push(stage);\n    DEBUG && console.log('Starting app...');\n    stage.start();\n  }, opts);\n};\n\nvar loading = _await();\n\nClass.preload = function(load) {\n  if (typeof load === 'string') {\n    var url = Class.resolve(load);\n    if (/\\.js($|\\?|\\#)/.test(url)) {\n      DEBUG && console.log('Loading script: ' + url);\n      load = function(callback) {\n        loadScript(url, callback);\n      };\n    }\n  }\n  if (typeof load !== 'function') {\n    return;\n  }\n  // if (!_started) {\n  // _preload_queue.push(load);\n  // return;\n  // }\n  load(loading());\n};\n\nClass.start = function(config) {\n  DEBUG && console.log('Starting...');\n\n  Class.config(config);\n\n  // DEBUG && console.log('Preloading...');\n  // _started = true;\n  // while (_preload_queue.length) {\n  // var load = _preload_queue.shift();\n  // load(loading());\n  // }\n\n  loading.then(function() {\n    DEBUG && console.log('Loading apps...');\n    _loaded = true;\n    while (_app_queue.length) {\n      var args = _app_queue.shift();\n      Class.app.apply(Class, args);\n    }\n  });\n};\n\nClass.pause = function() {\n  if (!_paused) {\n    _paused = true;\n    for (var i = _stages.length - 1; i >= 0; i--) {\n      _stages[i].pause();\n    }\n  }\n};\n\nClass.resume = function() {\n  if (_paused) {\n    _paused = false;\n    for (var i = _stages.length - 1; i >= 0; i--) {\n      _stages[i].resume();\n    }\n  }\n};\n\nClass.create = function() {\n  return new Class();\n};\n\nClass.resolve = (function() {\n\n  if (typeof window === 'undefined' || typeof document === 'undefined') {\n    return function(url) {\n      return url;\n    };\n  }\n\n  var scripts = document.getElementsByTagName('script');\n\n  function getScriptSrc() {\n    // HTML5\n    if (document.currentScript) {\n      return document.currentScript.src;\n    }\n\n    // IE>=10\n    var stack;\n    try {\n      var err = new Error();\n      if (err.stack) {\n        stack = err.stack;\n      } else {\n        throw err;\n      }\n    } catch (err) {\n      stack = err.stack;\n    }\n    if (typeof stack === 'string') {\n      stack = stack.split('\\n');\n      // Uses the last line, where the call started\n      for (var i = stack.length; i--;) {\n        var url = stack[i].match(/(\\w+\\:\\/\\/[^/]*?\\/.+?)(:\\d+)(:\\d+)?/);\n        if (url) {\n          return url[1];\n        }\n      }\n    }\n\n    // IE<11\n    if (scripts.length && 'readyState' in scripts[0]) {\n      for (var i = scripts.length; i--;) {\n        if (scripts[i].readyState === 'interactive') {\n          return scripts[i].src;\n        }\n      }\n    }\n\n    return location.href;\n  }\n\n  return function(url) {\n    if (/^\\.\\//.test(url)) {\n      var src = getScriptSrc();\n      var base = src.substring(0, src.lastIndexOf('/') + 1);\n      url = base + url.substring(2);\n      // } else if (/^\\.\\.\\//.test(url)) {\n      // url = base + url;\n    }\n    return url;\n  };\n})();\n\nmodule.exports = Class;\n\nfunction loadScript(src, callback) {\n  var el = document.createElement('script');\n  el.addEventListener('load', function() {\n    callback();\n  });\n  el.addEventListener('error', function(err) {\n    callback(err || 'Error loading script: ' + src);\n  });\n  el.src = src;\n  el.id = 'preload-' + Date.now();\n  document.body.appendChild(el);\n};","if (typeof Object.create == 'function') {\n  module.exports = function(proto, props) {\n    return Object.create.call(Object, proto, props);\n  };\n} else {\n  module.exports = function(proto, props) {\n    if (props)\n      throw Error('Second argument is not supported!');\n    if (typeof proto !== 'object' || proto === null)\n      throw Error('Invalid prototype!');\n    noop.prototype = proto;\n    return new noop;\n  };\n  function noop() {\n  }\n}\n","var Class = require('./core');\nvar Matrix = require('./matrix');\n\nvar iid = 0;\n\nClass._init(function() {\n  this._pin = new Pin(this);\n});\n\nClass.prototype.matrix = function(relative) {\n  if (relative === true) {\n    return this._pin.relativeMatrix();\n  }\n  return this._pin.absoluteMatrix();\n};\n\nClass.prototype.pin = function(a, b) {\n  if (typeof a === 'object') {\n    this._pin.set(a);\n    return this;\n\n  } else if (typeof a === 'string') {\n    if (typeof b === 'undefined') {\n      return this._pin.get(a);\n    } else {\n      this._pin.set(a, b);\n      return this;\n    }\n  } else if (typeof a === 'undefined') {\n    return this._pin;\n  }\n};\n\nfunction Pin(owner) {\n\n  this._owner = owner;\n  this._parent = null;\n\n  // relative to parent\n  this._relativeMatrix = new Matrix();\n\n  // relative to stage\n  this._absoluteMatrix = new Matrix();\n\n  this.reset();\n};\n\nPin.prototype.reset = function() {\n\n  this._textureAlpha = 1;\n  this._alpha = 1;\n\n  this._width = 0;\n  this._height = 0;\n\n  this._scaleX = 1;\n  this._scaleY = 1;\n  this._skewX = 0;\n  this._skewY = 0;\n  this._rotation = 0;\n\n  // scale/skew/rotate center\n  this._pivoted = false;\n  this._pivotX = null;\n  this._pivotY = null;\n\n  // self pin point\n  this._handled = false;\n  this._handleX = 0;\n  this._handleY = 0;\n\n  // parent pin point\n  this._aligned = false;\n  this._alignX = 0;\n  this._alignY = 0;\n\n  // as seen by parent px\n  this._offsetX = 0;\n  this._offsetY = 0;\n\n  this._boxX = 0;\n  this._boxY = 0;\n  this._boxWidth = this._width;\n  this._boxHeight = this._height;\n\n  // TODO: also set for owner\n  this._ts_translate = ++iid;\n  this._ts_transform = ++iid;\n  this._ts_matrix = ++iid;\n};\n\nPin.prototype._update = function() {\n  this._parent = this._owner._parent && this._owner._parent._pin;\n\n  // if handled and transformed then be translated\n  if (this._handled && this._mo_handle != this._ts_transform) {\n    this._mo_handle = this._ts_transform;\n    this._ts_translate = ++iid;\n  }\n\n  if (this._aligned && this._parent\n      && this._mo_align != this._parent._ts_transform) {\n    this._mo_align = this._parent._ts_transform;\n    this._ts_translate = ++iid;\n  }\n\n  return this;\n};\n\nPin.prototype.toString = function() {\n  return this._owner + ' (' + (this._parent ? this._parent._owner : null) + ')';\n};\n\n// TODO: ts fields require refactoring\n\nPin.prototype.absoluteMatrix = function() {\n  this._update();\n  var ts = Math.max(\n    this._ts_transform,\n    this._ts_translate,\n    this._parent ? this._parent._ts_matrix : 0\n  );\n  if (this._mo_abs == ts) {\n    return this._absoluteMatrix;\n  }\n  this._mo_abs = ts;\n\n  var abs = this._absoluteMatrix;\n  abs.reset(this.relativeMatrix());\n\n  this._parent && abs.concat(this._parent._absoluteMatrix);\n\n  this._ts_matrix = ++iid;\n\n  return abs;\n};\n\nPin.prototype.relativeMatrix = function() {\n  this._update();\n  var ts = Math.max(this._ts_transform, this._ts_translate,\n      this._parent ? this._parent._ts_transform : 0);\n  if (this._mo_rel == ts) {\n    return this._relativeMatrix;\n  }\n  this._mo_rel = ts;\n\n  var rel = this._relativeMatrix;\n\n  rel.identity();\n  if (this._pivoted) {\n    rel.translate(-this._pivotX * this._width, -this._pivotY * this._height);\n  }\n  rel.scale(this._scaleX, this._scaleY);\n  rel.skew(this._skewX, this._skewY);\n  rel.rotate(this._rotation);\n  if (this._pivoted) {\n    rel.translate(this._pivotX * this._width, this._pivotY * this._height);\n  }\n\n  // calculate effective box\n  if (this._pivoted) {\n    // origin\n    this._boxX = 0;\n    this._boxY = 0;\n    this._boxWidth = this._width;\n    this._boxHeight = this._height;\n\n  } else {\n    // aabb\n    var p, q;\n    if (rel.a > 0 && rel.c > 0 || rel.a < 0 && rel.c < 0) {\n      p = 0, q = rel.a * this._width + rel.c * this._height;\n    } else {\n      p = rel.a * this._width, q = rel.c * this._height;\n    }\n    if (p > q) {\n      this._boxX = q;\n      this._boxWidth = p - q;\n    } else {\n      this._boxX = p;\n      this._boxWidth = q - p;\n    }\n    if (rel.b > 0 && rel.d > 0 || rel.b < 0 && rel.d < 0) {\n      p = 0, q = rel.b * this._width + rel.d * this._height;\n    } else {\n      p = rel.b * this._width, q = rel.d * this._height;\n    }\n    if (p > q) {\n      this._boxY = q;\n      this._boxHeight = p - q;\n    } else {\n      this._boxY = p;\n      this._boxHeight = q - p;\n    }\n  }\n\n  this._x = this._offsetX;\n  this._y = this._offsetY;\n\n  this._x -= this._boxX + this._handleX * this._boxWidth;\n  this._y -= this._boxY + this._handleY * this._boxHeight;\n\n  if (this._aligned && this._parent) {\n    this._parent.relativeMatrix();\n    this._x += this._alignX * this._parent._width;\n    this._y += this._alignY * this._parent._height;\n  }\n\n  rel.translate(this._x, this._y);\n\n  return this._relativeMatrix;\n};\n\nPin.prototype.get = function(key) {\n  if (typeof getters[key] === 'function') {\n    return getters[key](this);\n  }\n};\n\n// TODO: Use defineProperty instead? What about multi-field pinning?\nPin.prototype.set = function(a, b) {\n  if (typeof a === 'string') {\n    if (typeof setters[a] === 'function' && typeof b !== 'undefined') {\n      setters[a](this, b);\n    }\n  } else if (typeof a === 'object') {\n    for (b in a) {\n      if (typeof setters[b] === 'function' && typeof a[b] !== 'undefined') {\n        setters[b](this, a[b], a);\n      }\n    }\n  }\n  if (this._owner) {\n    this._owner._ts_pin = ++iid;\n    this._owner.touch();\n  }\n  return this;\n};\n\nvar getters = {\n  alpha : function(pin) {\n    return pin._alpha;\n  },\n\n  textureAlpha : function(pin) {\n    return pin._textureAlpha;\n  },\n\n  width : function(pin) {\n    return pin._width;\n  },\n\n  height : function(pin) {\n    return pin._height;\n  },\n\n  boxWidth : function(pin) {\n    return pin._boxWidth;\n  },\n\n  boxHeight : function(pin) {\n    return pin._boxHeight;\n  },\n\n  // scale : function(pin) {\n  // },\n\n  scaleX : function(pin) {\n    return pin._scaleX;\n  },\n\n  scaleY : function(pin) {\n    return pin._scaleY;\n  },\n\n  // skew : function(pin) {\n  // },\n\n  skewX : function(pin) {\n    return pin._skewX;\n  },\n\n  skewY : function(pin) {\n    return pin._skewY;\n  },\n\n  rotation : function(pin) {\n    return pin._rotation;\n  },\n\n  // pivot : function(pin) {\n  // },\n\n  pivotX : function(pin) {\n    return pin._pivotX;\n  },\n\n  pivotY : function(pin) {\n    return pin._pivotY;\n  },\n\n  // offset : function(pin) {\n  // },\n\n  offsetX : function(pin) {\n    return pin._offsetX;\n  },\n\n  offsetY : function(pin) {\n    return pin._offsetY;\n  },\n\n  // align : function(pin) {\n  // },\n\n  alignX : function(pin) {\n    return pin._alignX;\n  },\n\n  alignY : function(pin) {\n    return pin._alignY;\n  },\n\n  // handle : function(pin) {\n  // },\n\n  handleX : function(pin) {\n    return pin._handleX;\n  },\n\n  handleY : function(pin) {\n    return pin._handleY;\n  }\n};\n\nvar setters = {\n  alpha : function(pin, value) {\n    pin._alpha = value;\n  },\n\n  textureAlpha : function(pin, value) {\n    pin._textureAlpha = value;\n  },\n\n  width : function(pin, value) {\n    pin._width_ = value;\n    pin._width = value;\n    pin._ts_transform = ++iid;\n  },\n\n  height : function(pin, value) {\n    pin._height_ = value;\n    pin._height = value;\n    pin._ts_transform = ++iid;\n  },\n\n  scale : function(pin, value) {\n    pin._scaleX = value;\n    pin._scaleY = value;\n    pin._ts_transform = ++iid;\n  },\n\n  scaleX : function(pin, value) {\n    pin._scaleX = value;\n    pin._ts_transform = ++iid;\n  },\n\n  scaleY : function(pin, value) {\n    pin._scaleY = value;\n    pin._ts_transform = ++iid;\n  },\n\n  skew : function(pin, value) {\n    pin._skewX = value;\n    pin._skewY = value;\n    pin._ts_transform = ++iid;\n  },\n\n  skewX : function(pin, value) {\n    pin._skewX = value;\n    pin._ts_transform = ++iid;\n  },\n\n  skewY : function(pin, value) {\n    pin._skewY = value;\n    pin._ts_transform = ++iid;\n  },\n\n  rotation : function(pin, value) {\n    pin._rotation = value;\n    pin._ts_transform = ++iid;\n  },\n\n  pivot : function(pin, value) {\n    pin._pivotX = value;\n    pin._pivotY = value;\n    pin._pivoted = true;\n    pin._ts_transform = ++iid;\n  },\n\n  pivotX : function(pin, value) {\n    pin._pivotX = value;\n    pin._pivoted = true;\n    pin._ts_transform = ++iid;\n  },\n\n  pivotY : function(pin, value) {\n    pin._pivotY = value;\n    pin._pivoted = true;\n    pin._ts_transform = ++iid;\n  },\n\n  offset : function(pin, value) {\n    pin._offsetX = value;\n    pin._offsetY = value;\n    pin._ts_translate = ++iid;\n  },\n\n  offsetX : function(pin, value) {\n    pin._offsetX = value;\n    pin._ts_translate = ++iid;\n  },\n\n  offsetY : function(pin, value) {\n    pin._offsetY = value;\n    pin._ts_translate = ++iid;\n  },\n\n  align : function(pin, value) {\n    this.alignX(pin, value);\n    this.alignY(pin, value);\n  },\n\n  alignX : function(pin, value) {\n    pin._alignX = value;\n    pin._aligned = true;\n    pin._ts_translate = ++iid;\n\n    this.handleX(pin, value);\n  },\n\n  alignY : function(pin, value) {\n    pin._alignY = value;\n    pin._aligned = true;\n    pin._ts_translate = ++iid;\n\n    this.handleY(pin, value);\n  },\n\n  handle : function(pin, value) {\n    this.handleX(pin, value);\n    this.handleY(pin, value);\n  },\n\n  handleX : function(pin, value) {\n    pin._handleX = value;\n    pin._handled = true;\n    pin._ts_translate = ++iid;\n  },\n\n  handleY : function(pin, value) {\n    pin._handleY = value;\n    pin._handled = true;\n    pin._ts_translate = ++iid;\n  },\n\n  resizeMode : function(pin, value, all) {\n    if (all) {\n      if (value == 'in') {\n        value = 'in-pad';\n      } else if (value == 'out') {\n        value = 'out-crop';\n      }\n      scaleTo(pin, all.resizeWidth, all.resizeHeight, value);\n    }\n  },\n\n  resizeWidth : function(pin, value, all) {\n    if (!all || !all.resizeMode) {\n      scaleTo(pin, value, null);\n    }\n  },\n\n  resizeHeight : function(pin, value, all) {\n    if (!all || !all.resizeMode) {\n      scaleTo(pin, null, value);\n    }\n  },\n\n  scaleMode : function(pin, value, all) {\n    if (all) {\n      scaleTo(pin, all.scaleWidth, all.scaleHeight, value);\n    }\n  },\n\n  scaleWidth : function(pin, value, all) {\n    if (!all || !all.scaleMode) {\n      scaleTo(pin, value, null);\n    }\n  },\n\n  scaleHeight : function(pin, value, all) {\n    if (!all || !all.scaleMode) {\n      scaleTo(pin, null, value);\n    }\n  },\n\n  matrix : function(pin, value) {\n    this.scaleX(pin, value.a);\n    this.skewX(pin, value.c / value.d);\n    this.skewY(pin, value.b / value.a);\n    this.scaleY(pin, value.d);\n    this.offsetX(pin, value.e);\n    this.offsetY(pin, value.f);\n    this.rotation(pin, 0);\n  }\n};\n\nfunction scaleTo(pin, width, height, mode) {\n  var w = typeof width === 'number';\n  var h = typeof height === 'number';\n  var m = typeof mode === 'string';\n  pin._ts_transform = ++iid;\n  if (w) {\n    pin._scaleX = width / pin._width_;\n    pin._width = pin._width_;\n  }\n  if (h) {\n    pin._scaleY = height / pin._height_;\n    pin._height = pin._height_;\n  }\n  if (w && h && m) {\n    if (mode == 'out' || mode == 'out-crop') {\n      pin._scaleX = pin._scaleY = Math.max(pin._scaleX, pin._scaleY);\n    } else if (mode == 'in' || mode == 'in-pad') {\n      pin._scaleX = pin._scaleY = Math.min(pin._scaleX, pin._scaleY);\n    }\n    if (mode == 'out-crop' || mode == 'in-pad') {\n      pin._width = width / pin._scaleX;\n      pin._height = height / pin._scaleY;\n    }\n  }\n};\n\nClass.prototype.scaleTo = function(a, b, c) {\n  if (typeof a === 'object')\n    c = b, b = a.y, a = a.x;\n  scaleTo(this._pin, a, b, c);\n  return this;\n};\n\n// Used by Tween class\nPin._add_shortcuts = function(Class) {\n  Class.prototype.size = function(w, h) {\n    this.pin('width', w);\n    this.pin('height', h);\n    return this;\n  };\n\n  Class.prototype.width = function(w) {\n    if (typeof w === 'undefined') {\n      return this.pin('width');\n    }\n    this.pin('width', w);\n    return this;\n  };\n\n  Class.prototype.height = function(h) {\n    if (typeof h === 'undefined') {\n      return this.pin('height');\n    }\n    this.pin('height', h);\n    return this;\n  };\n\n  Class.prototype.offset = function(a, b) {\n    if (typeof a === 'object')\n      b = a.y, a = a.x;\n    this.pin('offsetX', a);\n    this.pin('offsetY', b);\n    return this;\n  };\n\n  Class.prototype.rotate = function(a) {\n    this.pin('rotation', a);\n    return this;\n  };\n\n  Class.prototype.skew = function(a, b) {\n    if (typeof a === 'object')\n      b = a.y, a = a.x;\n    else if (typeof b === 'undefined')\n      b = a;\n    this.pin('skewX', a);\n    this.pin('skewY', b);\n    return this;\n  };\n\n  Class.prototype.scale = function(a, b) {\n    if (typeof a === 'object')\n      b = a.y, a = a.x;\n    else if (typeof b === 'undefined')\n      b = a;\n    this.pin('scaleX', a);\n    this.pin('scaleY', b);\n    return this;\n  };\n\n  Class.prototype.alpha = function(a, ta) {\n    this.pin('alpha', a);\n    if (typeof ta !== 'undefined') {\n      this.pin('textureAlpha', ta);\n    }\n    return this;\n  };\n};\n\nPin._add_shortcuts(Class);\n\nmodule.exports = Pin;\n","var Class = require('./core');\nrequire('./pin');\nvar stats = require('./util/stats');\n\nClass.prototype._textures = null;\nClass.prototype._alpha = 1;\n\nClass.prototype.render = function(context) {\n  if (!this._visible) {\n    return;\n  }\n  stats.node++;\n\n  var m = this.matrix();\n  context.setTransform(m.a, m.b, m.c, m.d, m.e, m.f);\n\n  // move this elsewhere!\n  this._alpha = this._pin._alpha * (this._parent ? this._parent._alpha : 1);\n  var alpha = this._pin._textureAlpha * this._alpha;\n\n  if (context.globalAlpha != alpha) {\n    context.globalAlpha = alpha;\n  }\n\n  if (this._textures !== null) {\n    for (var i = 0, n = this._textures.length; i < n; i++) {\n      this._textures[i].draw(context);\n    }\n  }\n\n  if (context.globalAlpha != this._alpha) {\n    context.globalAlpha = this._alpha;\n  }\n\n  var child, next = this._first;\n  while (child = next) {\n    next = child._next;\n    child.render(context);\n  }\n};\n\nClass.prototype._tickBefore = null;\nClass.prototype._tickAfter = null;\nClass.prototype.MAX_ELAPSE = Infinity;\n\nClass.prototype._tick = function(elapsed, now, last) {\n  if (!this._visible) {\n    return;\n  }\n\n  if (elapsed > this.MAX_ELAPSE) {\n    elapsed = this.MAX_ELAPSE;\n  }\n\n  var ticked = false;\n\n  if (this._tickBefore !== null) {\n    for (var i = 0; i < this._tickBefore.length; i++) {\n      stats.tick++;\n      var tickFn = this._tickBefore[i];\n      ticked = tickFn.call(this, elapsed, now, last) === true || ticked;\n    }\n  }\n\n  var child, next = this._first;\n  while (child = next) {\n    next = child._next;\n    if (child._flag('_tick')) {\n      ticked = child._tick(elapsed, now, last) === true ? true : ticked;\n    }\n  }\n\n  if (this._tickAfter !== null) {\n    for (var i = 0; i < this._tickAfter.length; i++) {\n      stats.tick++;\n      var tickFn = this._tickAfter[i];\n      ticked = tickFn.call(this, elapsed, now, last) === true || ticked;\n    }\n  }\n\n  return ticked;\n};\n\nClass.prototype.tick = function(ticker, before) {\n  if (typeof ticker !== 'function') {\n    return;\n  }\n  if (before) {\n    if (this._tickBefore === null) {\n      this._tickBefore = [];\n    }\n    this._tickBefore.push(ticker);\n  } else {\n    if (this._tickAfter === null) {\n      this._tickAfter = [];\n    }\n    this._tickAfter.push(ticker);\n  }\n  this._flag('_tick', this._tickAfter !== null && this._tickAfter.length > 0\n      || this._tickBefore !== null && this._tickBefore.length > 0);\n};\n\nClass.prototype.untick = function(ticker) {\n  if (typeof ticker !== 'function') {\n    return;\n  }\n  var i;\n  if (this._tickBefore !== null && (i = this._tickBefore.indexOf(ticker)) >= 0) {\n    this._tickBefore.splice(i, 1);\n  }\n  if (this._tickAfter !== null && (i = this._tickAfter.indexOf(ticker)) >= 0) {\n    this._tickAfter.splice(i, 1);\n  }\n};\n\nClass.prototype.timeout = function(fn, time) {\n  this.setTimeout(fn, time);\n};\n\nClass.prototype.setTimeout = function(fn, time) {\n  function timer(t) {\n    if ((time -= t) < 0) {\n      this.untick(timer);\n      fn.call(this);\n    } else {\n      return true;\n    }\n  }\n  this.tick(timer);\n  return timer;\n};\n\nClass.prototype.clearTimeout = function(timer) {\n  this.untick(timer);\n};\n\n","module.exports = {};\n","module.exports = function(base) {\n  for (var i = 1; i < arguments.length; i++) {\n    var obj = arguments[i];\n    for ( var key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        base[key] = obj[key];\n      }\n    }\n  }\n  return base;\n};\n","/**\n * ! is the definitive JavaScript type testing library\n * \n * @copyright 2013-2014 Enrico Marino / Jordan Harband\n * @license MIT\n */\n\nvar objProto = Object.prototype;\nvar owns = objProto.hasOwnProperty;\nvar toStr = objProto.toString;\n\nvar NON_HOST_TYPES = {\n  'boolean' : 1,\n  'number' : 1,\n  'string' : 1,\n  'undefined' : 1\n};\n\nvar hexRegex = /^[A-Fa-f0-9]+$/;\n\nvar is = module.exports = {};\n\nis.a = is.an = is.type = function(value, type) {\n  return typeof value === type;\n};\n\nis.defined = function(value) {\n  return typeof value !== 'undefined';\n};\n\nis.empty = function(value) {\n  var type = toStr.call(value);\n  var key;\n\n  if ('[object Array]' === type || '[object Arguments]' === type\n      || '[object String]' === type) {\n    return value.length === 0;\n  }\n\n  if ('[object Object]' === type) {\n    for (key in value) {\n      if (owns.call(value, key)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  return !value;\n};\n\nis.equal = function(value, other) {\n  if (value === other) {\n    return true;\n  }\n\n  var type = toStr.call(value);\n  var key;\n\n  if (type !== toStr.call(other)) {\n    return false;\n  }\n\n  if ('[object Object]' === type) {\n    for (key in value) {\n      if (!is.equal(value[key], other[key]) || !(key in other)) {\n        return false;\n      }\n    }\n    for (key in other) {\n      if (!is.equal(value[key], other[key]) || !(key in value)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  if ('[object Array]' === type) {\n    key = value.length;\n    if (key !== other.length) {\n      return false;\n    }\n    while (--key) {\n      if (!is.equal(value[key], other[key])) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  if ('[object Function]' === type) {\n    return value.prototype === other.prototype;\n  }\n\n  if ('[object Date]' === type) {\n    return value.getTime() === other.getTime();\n  }\n\n  return false;\n};\n\nis.instance = function(value, constructor) {\n  return value instanceof constructor;\n};\n\nis.nil = function(value) {\n  return value === null;\n};\n\nis.undef = function(value) {\n  return typeof value === 'undefined';\n};\n\nis.array = function(value) {\n  return '[object Array]' === toStr.call(value);\n};\n\nis.emptyarray = function(value) {\n  return is.array(value) && value.length === 0;\n};\n\nis.arraylike = function(value) {\n  return !!value && !is.boolean(value) && owns.call(value, 'length')\n      && isFinite(value.length) && is.number(value.length) && value.length >= 0;\n};\n\nis.boolean = function(value) {\n  return '[object Boolean]' === toStr.call(value);\n};\n\nis.element = function(value) {\n  return value !== undefined && typeof HTMLElement !== 'undefined'\n      && value instanceof HTMLElement && value.nodeType === 1;\n};\n\nis.fn = function(value) {\n  return '[object Function]' === toStr.call(value);\n};\n\nis.number = function(value) {\n  return '[object Number]' === toStr.call(value);\n};\n\nis.nan = function(value) {\n  return !is.number(value) || value !== value;\n};\n\nis.object = function(value) {\n  return '[object Object]' === toStr.call(value);\n};\n\nis.hash = function(value) {\n  return is.object(value) && value.constructor === Object && !value.nodeType\n      && !value.setInterval;\n};\n\nis.regexp = function(value) {\n  return '[object RegExp]' === toStr.call(value);\n};\n\nis.string = function(value) {\n  return '[object String]' === toStr.call(value);\n};\n\nis.hex = function(value) {\n  return is.string(value) && (!value.length || hexRegex.test(value));\n};\n","var stats = require('./util/stats');\nvar math = require('./util/math');\n\nfunction Texture(image, ratio) {\n  if (typeof image === 'object') {\n    this.src(image, ratio);\n  }\n}\n\nTexture.prototype.pipe = function() {\n  return new Texture(this);\n};\n\n/**\n * Signatures: (image), (x, y, w, h), (w, h)\n */\nTexture.prototype.src = function(x, y, w, h) {\n  if (typeof x === 'object') {\n    var image = x, ratio = y || 1;\n\n    this._image = image;\n    this._sx = this._dx = 0;\n    this._sy = this._dy = 0;\n    this._sw = this._dw = image.width / ratio;\n    this._sh = this._dh = image.height / ratio;\n\n    this.width = image.width / ratio;\n    this.height = image.height / ratio;\n\n    this.ratio = ratio;\n\n  } else {\n    if (typeof w === 'undefined') {\n      w = x, h = y;\n    } else {\n      this._sx = x, this._sy = y;\n    }\n    this._sw = this._dw = w;\n    this._sh = this._dh = h;\n\n    this.width = w;\n    this.height = h;\n  }\n  return this;\n};\n\n/**\n * Signatures: (x, y, w, h), (x, y)\n */\nTexture.prototype.dest = function(x, y, w, h) {\n  this._dx = x, this._dy = y;\n  this._dx = x, this._dy = y;\n  if (typeof w !== 'undefined') {\n    this._dw = w, this._dh = h;\n    this.width = w, this.height = h;\n  }\n  return this;\n};\n\nTexture.prototype.draw = function(context, x1, y1, x2, y2, x3, y3, x4, y4) {\n  var image = this._image;\n  if (image === null || typeof image !== 'object') {\n    return;\n  }\n\n  var sx = this._sx, sy = this._sy;\n  var sw = this._sw, sh = this._sh;\n  var dx = this._dx, dy = this._dy;\n  var dw = this._dw, dh = this._dh;\n\n  if (typeof x3 !== 'undefined') {\n    x1 = math.limit(x1, 0, this._sw), x2 = math.limit(x2, 0, this._sw - x1);\n    y1 = math.limit(y1, 0, this._sh), y2 = math.limit(y2, 0, this._sh - y1);\n    sx += x1, sy += y1, sw = x2, sh = y2;\n    dx = x3, dy = y3, dw = x4, dh = y4;\n\n  } else if (typeof x2 !== 'undefined') {\n    dx = x1, dy = y1, dw = x2, dh = y2;\n\n  } else if (typeof x1 !== 'undefined') {\n    dw = x1, dh = y1;\n  }\n\n  var ratio = this.ratio || 1;\n  sx *= ratio, sy *= ratio, sw *= ratio, sh *= ratio;\n\n  try {\n    if (typeof image.draw === 'function') {\n      image.draw(context, sx, sy, sw, sh, dx, dy, dw, dh);\n    } else {\n      stats.draw++;\n      context.drawImage(image, sx, sy, sw, sh, dx, dy, dw, dh);\n    }\n  } catch (ex) {\n    if (!image._draw_failed) {\n      console.log('Unable to draw: ', image);\n      console.log(ex);\n      image._draw_failed = true;\n    }\n  }\n};\n\nmodule.exports = Texture;\n","var create = require('./create');\nvar native = Math;\n\nmodule.exports = create(Math);\n\nmodule.exports.random = function(min, max) {\n  if (typeof min === 'undefined') {\n    max = 1, min = 0;\n  } else if (typeof max === 'undefined') {\n    max = min, min = 0;\n  }\n  return min == max ? min : native.random() * (max - min) + min;\n};\n\nmodule.exports.rotate = function(num, min, max) {\n  if (typeof min === 'undefined') {\n    max = 1, min = 0;\n  } else if (typeof max === 'undefined') {\n    max = min, min = 0;\n  }\n  if (max > min) {\n    num = (num - min) % (max - min);\n    return num + (num < 0 ? max : min);\n  } else {\n    num = (num - max) % (min - max);\n    return num + (num <= 0 ? min : max);\n  }\n};\n\nmodule.exports.limit = function(num, min, max) {\n  if (num < min) {\n    return min;\n  } else if (num > max) {\n    return max;\n  } else {\n    return num;\n  }\n};\n\nmodule.exports.length = function(x, y) {\n  return native.sqrt(x * x + y * y);\n};","function Matrix(a, b, c, d, e, f) {\n  this.reset(a, b, c, d, e, f);\n};\n\nMatrix.prototype.toString = function() {\n  return '[' + this.a + ', ' + this.b + ', ' + this.c + ', ' + this.d + ', '\n      + this.e + ', ' + this.f + ']';\n};\n\nMatrix.prototype.clone = function() {\n  return new Matrix(this.a, this.b, this.c, this.d, this.e, this.f);\n};\n\nMatrix.prototype.reset = function(a, b, c, d, e, f) {\n  this._dirty = true;\n  if (typeof a === 'object') {\n    this.a = a.a, this.d = a.d;\n    this.b = a.b, this.c = a.c;\n    this.e = a.e, this.f = a.f;\n  } else {\n    this.a = a || 1, this.d = d || 1;\n    this.b = b || 0, this.c = c || 0;\n    this.e = e || 0, this.f = f || 0;\n  }\n  return this;\n};\n\nMatrix.prototype.identity = function() {\n  this._dirty = true;\n  this.a = 1;\n  this.b = 0;\n  this.c = 0;\n  this.d = 1;\n  this.e = 0;\n  this.f = 0;\n  return this;\n};\n\nMatrix.prototype.rotate = function(angle) {\n  if (!angle) {\n    return this;\n  }\n\n  this._dirty = true;\n\n  var u = angle ? Math.cos(angle) : 1;\n  // android bug may give bad 0 values\n  var v = angle ? Math.sin(angle) : 0;\n\n  var a = u * this.a - v * this.b;\n  var b = u * this.b + v * this.a;\n  var c = u * this.c - v * this.d;\n  var d = u * this.d + v * this.c;\n  var e = u * this.e - v * this.f;\n  var f = u * this.f + v * this.e;\n\n  this.a = a;\n  this.b = b;\n  this.c = c;\n  this.d = d;\n  this.e = e;\n  this.f = f;\n\n  return this;\n};\n\nMatrix.prototype.translate = function(x, y) {\n  if (!x && !y) {\n    return this;\n  }\n  this._dirty = true;\n  this.e += x;\n  this.f += y;\n  return this;\n};\n\nMatrix.prototype.scale = function(x, y) {\n  if (!(x - 1) && !(y - 1)) {\n    return this;\n  }\n  this._dirty = true;\n  this.a *= x;\n  this.b *= y;\n  this.c *= x;\n  this.d *= y;\n  this.e *= x;\n  this.f *= y;\n  return this;\n};\n\nMatrix.prototype.skew = function(x, y) {\n  if (!x && !y) {\n    return this;\n  }\n  this._dirty = true;\n\n  var a = this.a + this.b * x;\n  var b = this.b + this.a * y;\n  var c = this.c + this.d * x;\n  var d = this.d + this.c * y;\n  var e = this.e + this.f * x;\n  var f = this.f + this.e * y;\n\n  this.a = a;\n  this.b = b;\n  this.c = c;\n  this.d = d;\n  this.e = e;\n  this.f = f;\n  return this;\n};\n\nMatrix.prototype.concat = function(m) {\n  this._dirty = true;\n\n  var n = this;\n\n  var a = n.a * m.a + n.b * m.c;\n  var b = n.b * m.d + n.a * m.b;\n  var c = n.c * m.a + n.d * m.c;\n  var d = n.d * m.d + n.c * m.b;\n  var e = n.e * m.a + m.e + n.f * m.c;\n  var f = n.f * m.d + m.f + n.e * m.b;\n\n  this.a = a;\n  this.b = b;\n  this.c = c;\n  this.d = d;\n  this.e = e;\n  this.f = f;\n\n  return this;\n};\n\nMatrix.prototype.inverse = Matrix.prototype.reverse = function() {\n  if (this._dirty) {\n    this._dirty = false;\n    this.inversed = this.inversed || new Matrix();\n    var z = this.a * this.d - this.b * this.c;\n    this.inversed.a = this.d / z;\n    this.inversed.b = -this.b / z;\n    this.inversed.c = -this.c / z;\n    this.inversed.d = this.a / z;\n    this.inversed.e = (this.c * this.f - this.e * this.d) / z;\n    this.inversed.f = (this.e * this.b - this.a * this.f) / z;\n  }\n  return this.inversed;\n};\n\nMatrix.prototype.map = function(p, q) {\n  q = q || {};\n  q.x = this.a * p.x + this.c * p.y + this.e;\n  q.y = this.b * p.x + this.d * p.y + this.f;\n  return q;\n};\n\nMatrix.prototype.mapX = function(x, y) {\n  if (typeof x === 'object')\n    y = x.y, x = x.x;\n  return this.a * x + this.c * y + this.e;\n};\n\nMatrix.prototype.mapY = function(x, y) {\n  if (typeof x === 'object')\n    y = x.y, x = x.x;\n  return this.b * x + this.d * y + this.f;\n};\n\nmodule.exports = Matrix;\n","module.exports = require('./core');\nmodule.exports.Matrix = require('./matrix');\nmodule.exports.Texture = require('./texture');\nrequire('./atlas');\nrequire('./tree');\nrequire('./event');\nrequire('./pin');\n\nrequire('./loop');\nrequire('./root');","module.exports = function() {\n  var count = 0;\n  function fork(fn, n) {\n    count += n = (typeof n === 'number' && n >= 1 ? n : 1);\n    return function() {\n      fn && fn.apply(this, arguments);\n      if (n > 0) {\n        n--, count--, call();\n      }\n    };\n  }\n  var then = [];\n  function call() {\n    if (count === 0) {\n      while (then.length) {\n        setTimeout(then.shift(), 0);\n      }\n    }\n  }\n  fork.then = function(fn) {\n    if (count === 0) {\n      setTimeout(fn, 0);\n    } else {\n      then.push(fn);\n    }\n  };\n  return fork;\n};","if (typeof DEBUG === 'undefined')\n  DEBUG = true;\n\nvar Class = require('./core');\nvar Texture = require('./texture');\n\nvar extend = require('./util/extend');\nvar create = require('./util/create');\nvar is = require('./util/is');\n\nvar string = require('./util/string');\n\n// name : atlas\nvar _atlases_map = {};\n// [atlas]\nvar _atlases_arr = [];\n\n// TODO: print subquery not found error\n// TODO: index textures\n\nClass.atlas = function(def) {\n  var atlas = is.fn(def.draw) ? def : new Atlas(def);\n  if (def.name) {\n    _atlases_map[def.name] = atlas;\n  }\n  _atlases_arr.push(atlas);\n\n  deprecated(def, 'imagePath');\n  deprecated(def, 'imageRatio');\n\n  var url = def.imagePath;\n  var ratio = def.imageRatio || 1;\n  if (is.string(def.image)) {\n    url = def.image;\n  } else if (is.hash(def.image)) {\n    url = def.image.src || def.image.url;\n    ratio = def.image.ratio || ratio;\n  }\n  url && Class.preload(function(done) {\n    url = Class.resolve(url);\n    DEBUG && console.log('Loading atlas: ' + url);\n    var imageloader = Class.config('image-loader');\n\n    imageloader(url, function(image) {\n      DEBUG && console.log('Image loaded: ' + url);\n      atlas.src(image, ratio);\n      done();\n\n    }, function(err) {\n      DEBUG && console.log('Error loading atlas: ' + url, err);\n      done();\n    });\n  });\n\n  return atlas;\n};\n\nAtlas._super = Texture;\nAtlas.prototype = create(Atlas._super.prototype);\n\nfunction Atlas(def) {\n  Atlas._super.call(this);\n\n  var atlas = this;\n\n  deprecated(def, 'filter');\n  deprecated(def, 'cutouts');\n  deprecated(def, 'sprites');\n  deprecated(def, 'factory');\n\n  var map = def.map || def.filter;\n  var ppu = def.ppu || def.ratio || 1;\n  var trim = def.trim || 0;\n  var textures = def.textures;\n  var factory = def.factory;\n  var cutouts = def.cutouts || def.sprites;\n\n  function make(def) {\n    if (!def || is.fn(def.draw)) {\n      return def;\n    }\n\n    def = extend({}, def);\n\n    if (is.fn(map)) {\n      def = map(def);\n    }\n\n    if (ppu != 1) {\n      def.x *= ppu, def.y *= ppu;\n      def.width *= ppu, def.height *= ppu;\n      def.top *= ppu, def.bottom *= ppu;\n      def.left *= ppu, def.right *= ppu;\n    }\n\n    if (trim != 0) {\n      def.x += trim, def.y += trim;\n      def.width -= 2 * trim, def.height -= 2 * trim;\n      def.top -= trim, def.bottom -= trim;\n      def.left -= trim, def.right -= trim;\n    }\n\n    var texture = atlas.pipe();\n    texture.top = def.top, texture.bottom = def.bottom;\n    texture.left = def.left, texture.right = def.right;\n    texture.src(def.x, def.y, def.width, def.height);\n    return texture;\n  }\n\n  function find(query) {\n    if (textures) {\n      if (is.fn(textures)) {\n        return textures(query);\n      } else if (is.hash(textures)) {\n        return textures[query];\n      }\n    }\n    if (cutouts) { // deprecated\n      var result = null, n = 0;\n      for (var i = 0; i < cutouts.length; i++) {\n        if (string.startsWith(cutouts[i].name, query)) {\n          if (n === 0) {\n            result = cutouts[i];\n          } else if (n === 1) {\n            result = [ result, cutouts[i] ];\n          } else {\n            result.push(cutouts[i]);\n          }\n          n++;\n        }\n      }\n      if (n === 0 && is.fn(factory)) {\n        result = function(subquery) {\n          return factory(query + (subquery ? subquery : ''));\n        };\n      }\n      return result;\n    }\n  }\n\n  this.select = function(query) {\n    if (!query) {\n      // TODO: if `textures` is texture def, map or fn?\n      return new Selection(this.pipe());\n    }\n    var found = find(query);\n    if (found) {\n      return new Selection(found, find, make);\n    }\n  };\n\n};\n\nvar nfTexture = new Texture();\nnfTexture.x = nfTexture.y = nfTexture.width = nfTexture.height = 0;\nnfTexture.pipe = nfTexture.src = nfTexture.dest = function() {\n  return this;\n};\nnfTexture.draw = function() {\n};\n\nvar nfSelection = new Selection(nfTexture);\n\nfunction Selection(result, find, make) {\n  function link(result, subquery) {\n    if (!result) {\n      return nfTexture;\n\n    } else if (is.fn(result.draw)) {\n      return result;\n\n    } else if (is.hash(result) && is.number(result.width)\n        && is.number(result.height) && is.fn(make)) {\n      return make(result);\n\n    } else if (is.hash(result) && is.defined(subquery)) {\n      return link(result[subquery]);\n\n    } else if (is.fn(result)) {\n      return link(result(subquery));\n\n    } else if (is.array(result)) {\n      return link(result[0]);\n\n    } else if (is.string(result) && is.fn(find)) {\n      return link(find(result));\n    }\n  }\n\n  this.one = function(subquery) {\n    return link(result, subquery);\n  };\n\n  this.array = function(arr) {\n    var array = is.array(arr) ? arr : [];\n    if (is.array(result)) {\n      for (var i = 0; i < result.length; i++) {\n        array[i] = link(result[i]);\n      }\n    } else {\n      array[0] = link(result);\n    }\n    return array;\n  };\n}\n\nClass.texture = function(query) {\n  if (!is.string(query)) {\n    return new Selection(query);\n  }\n\n  var result = null, atlas, i;\n\n  if ((i = query.indexOf(':')) > 0 && query.length > i + 1) {\n    atlas = _atlases_map[query.slice(0, i)];\n    result = atlas && atlas.select(query.slice(i + 1));\n  }\n\n  if (!result && (atlas = _atlases_map[query])) {\n    result = atlas.select();\n  }\n\n  for (i = 0; !result && i < _atlases_arr.length; i++) {\n    result = _atlases_arr[i].select(query);\n  }\n\n  if (!result) {\n    console.error('Texture not found: ' + query);\n    result = nfSelection;\n  }\n\n  return result;\n};\n\nfunction deprecated(hash, name, msg) {\n  if (name in hash)\n    console.log(msg ? msg.replace('%name', name) : '\\'' + name\n        + '\\' field of texture atlas is deprecated.');\n};\n\nmodule.exports = Atlas;\n","module.exports.startsWith = function(str, sub) {\n  return typeof str === 'string' && typeof sub === 'string'\n      && str.substring(0, sub.length) == sub;\n};","var Class = require('./core');\nvar is = require('./util/is');\n\nvar iid = 0;\n\n// TODO: do not clear next/prev/parent on remove\n\nClass.prototype._label = '';\n\nClass.prototype._visible = true;\n\nClass.prototype._parent = null;\nClass.prototype._next = null;\nClass.prototype._prev = null;\n\nClass.prototype._first = null;\nClass.prototype._last = null;\n\nClass.prototype._attrs = null;\nClass.prototype._flags = null;\n\nClass.prototype.toString = function() {\n  return '[' + this._label + ']';\n};\n\n/**\n * @deprecated Use label()\n */\nClass.prototype.id = function(id) {\n  return this.label(id);\n};\n\nClass.prototype.label = function(label) {\n  if (typeof label === 'undefined') {\n    return this._label;\n  }\n  this._label = label;\n  return this;\n};\n\nClass.prototype.attr = function(name, value) {\n  if (typeof value === 'undefined') {\n    return this._attrs !== null ? this._attrs[name] : undefined;\n  }\n  (this._attrs !== null ? this._attrs : this._attrs = {})[name] = value;\n  return this;\n};\n\nClass.prototype.visible = function(visible) {\n  if (typeof visible === 'undefined') {\n    return this._visible;\n  }\n  this._visible = visible;\n  this._parent && (this._parent._ts_children = ++iid);\n  this._ts_pin = ++iid;\n  this.touch();\n  return this;\n};\n\nClass.prototype.hide = function() {\n  return this.visible(false);\n};\n\nClass.prototype.show = function() {\n  return this.visible(true);\n};\n\nClass.prototype.parent = function() {\n  return this._parent;\n};\n\nClass.prototype.next = function(visible) {\n  var next = this._next;\n  while (next && visible && !next._visible) {\n    next = next._next;\n  }\n  return next;\n};\n\nClass.prototype.prev = function(visible) {\n  var prev = this._prev;\n  while (prev && visible && !prev._visible) {\n    prev = prev._prev;\n  }\n  return prev;\n};\n\nClass.prototype.first = function(visible) {\n  var next = this._first;\n  while (next && visible && !next._visible) {\n    next = next._next;\n  }\n  return next;\n};\n\nClass.prototype.last = function(visible) {\n  var prev = this._last;\n  while (prev && visible && !prev._visible) {\n    prev = prev._prev;\n  }\n  return prev;\n};\n\nClass.prototype.visit = function(visitor, data) {\n  var reverse = visitor.reverse;\n  var visible = visitor.visible;\n  if (visitor.start && visitor.start(this, data)) {\n    return;\n  }\n  var child, next = reverse ? this.last(visible) : this.first(visible);\n  while (child = next) {\n    next = reverse ? child.prev(visible) : child.next(visible);\n    if (child.visit(visitor, data)) {\n      return true;\n    }\n  }\n  return visitor.end && visitor.end(this, data);\n};\n\nClass.prototype.append = function(child, more) {\n  if (is.array(child))\n    for (var i = 0; i < child.length; i++)\n      append(this, child[i]);\n\n  else if (typeof more !== 'undefined') // deprecated\n    for (var i = 0; i < arguments.length; i++)\n      append(this, arguments[i]);\n\n  else if (typeof child !== 'undefined')\n    append(this, child);\n\n  return this;\n};\n\nClass.prototype.prepend = function(child, more) {\n  if (is.array(child))\n    for (var i = child.length - 1; i >= 0; i--)\n      prepend(this, child[i]);\n\n  else if (typeof more !== 'undefined') // deprecated\n    for (var i = arguments.length - 1; i >= 0; i--)\n      prepend(this, arguments[i]);\n\n  else if (typeof child !== 'undefined')\n    prepend(this, child);\n\n  return this;\n};\n\nClass.prototype.appendTo = function(parent) {\n  append(parent, this);\n  return this;\n};\n\nClass.prototype.prependTo = function(parent) {\n  prepend(parent, this);\n  return this;\n};\n\nClass.prototype.insertNext = function(sibling, more) {\n  if (is.array(sibling))\n    for (var i = 0; i < sibling.length; i++)\n      insertAfter(sibling[i], this);\n\n  else if (typeof more !== 'undefined') // deprecated\n    for (var i = 0; i < arguments.length; i++)\n      insertAfter(arguments[i], this);\n\n  else if (typeof sibling !== 'undefined')\n    insertAfter(sibling, this);\n\n  return this;\n};\n\nClass.prototype.insertPrev = function(sibling, more) {\n  if (is.array(sibling))\n    for (var i = sibling.length - 1; i >= 0; i--)\n      insertBefore(sibling[i], this);\n\n  else if (typeof more !== 'undefined') // deprecated\n    for (var i = arguments.length - 1; i >= 0; i--)\n      insertBefore(arguments[i], this);\n\n  else if (typeof sibling !== 'undefined')\n    insertBefore(sibling, this);\n\n  return this;\n};\n\nClass.prototype.insertAfter = function(prev) {\n  insertAfter(this, prev);\n  return this;\n};\n\nClass.prototype.insertBefore = function(next) {\n  insertBefore(this, next);\n  return this;\n};\n\nfunction append(parent, child) {\n  _ensure(child);\n  _ensure(parent);\n\n  child.remove();\n\n  if (parent._last) {\n    parent._last._next = child;\n    child._prev = parent._last;\n  }\n\n  child._parent = parent;\n  parent._last = child;\n\n  if (!parent._first) {\n    parent._first = child;\n  }\n\n  child._parent._flag(child, true);\n\n  child._ts_parent = ++iid;\n  parent._ts_children = ++iid;\n  parent.touch();\n}\n\nfunction prepend(parent, child) {\n  _ensure(child);\n  _ensure(parent);\n\n  child.remove();\n\n  if (parent._first) {\n    parent._first._prev = child;\n    child._next = parent._first;\n  }\n\n  child._parent = parent;\n  parent._first = child;\n\n  if (!parent._last) {\n    parent._last = child;\n  }\n\n  child._parent._flag(child, true);\n\n  child._ts_parent = ++iid;\n  parent._ts_children = ++iid;\n  parent.touch();\n};\n\nfunction insertBefore(self, next) {\n  _ensure(self);\n  _ensure(next);\n\n  self.remove();\n\n  var parent = next._parent;\n  var prev = next._prev;\n\n  next._prev = self;\n  prev && (prev._next = self) || parent && (parent._first = self);\n\n  self._parent = parent;\n  self._prev = prev;\n  self._next = next;\n\n  self._parent._flag(self, true);\n\n  self._ts_parent = ++iid;\n  self.touch();\n};\n\nfunction insertAfter(self, prev) {\n  _ensure(self);\n  _ensure(prev);\n\n  self.remove();\n\n  var parent = prev._parent;\n  var next = prev._next;\n\n  prev._next = self;\n  next && (next._prev = self) || parent && (parent._last = self);\n\n  self._parent = parent;\n  self._prev = prev;\n  self._next = next;\n\n  self._parent._flag(self, true);\n\n  self._ts_parent = ++iid;\n  self.touch();\n};\n\nClass.prototype.remove = function(child, more) {\n  if (typeof child !== 'undefined') {\n    if (is.array(child)) {\n      for (var i = 0; i < child.length; i++)\n        _ensure(child[i]).remove();\n\n    } else if (typeof more !== 'undefined') {\n      for (var i = 0; i < arguments.length; i++)\n        _ensure(arguments[i]).remove();\n\n    } else {\n      _ensure(child).remove();\n    }\n    return this;\n  }\n\n  if (this._prev) {\n    this._prev._next = this._next;\n  }\n  if (this._next) {\n    this._next._prev = this._prev;\n  }\n\n  if (this._parent) {\n    if (this._parent._first === this) {\n      this._parent._first = this._next;\n    }\n    if (this._parent._last === this) {\n      this._parent._last = this._prev;\n    }\n\n    this._parent._flag(this, false);\n\n    this._parent._ts_children = ++iid;\n    this._parent.touch();\n  }\n\n  this._prev = this._next = this._parent = null;\n  this._ts_parent = ++iid;\n  // this._parent.touch();\n\n  return this;\n};\n\nClass.prototype.empty = function() {\n  var child, next = this._first;\n  while (child = next) {\n    next = child._next;\n    child._prev = child._next = child._parent = null;\n\n    this._flag(child, false);\n  }\n\n  this._first = this._last = null;\n\n  this._ts_children = ++iid;\n  this.touch();\n  return this;\n};\n\nClass.prototype.touch = function() {\n  this._ts_touch = ++iid;\n  this._parent && this._parent.touch();\n  return this;\n};\n\n/**\n * Deep flags used for optimizing event distribution.\n */\nClass.prototype._flag = function(obj, name) {\n  if (typeof name === 'undefined') {\n    return this._flags !== null && this._flags[obj] || 0;\n  }\n  if (typeof obj === 'string') {\n    if (name) {\n      this._flags = this._flags || {};\n      if (!this._flags[obj] && this._parent) {\n        this._parent._flag(obj, true);\n      }\n      this._flags[obj] = (this._flags[obj] || 0) + 1;\n\n    } else if (this._flags && this._flags[obj] > 0) {\n      if (this._flags[obj] == 1 && this._parent) {\n        this._parent._flag(obj, false);\n      }\n      this._flags[obj] = this._flags[obj] - 1;\n    }\n  }\n  if (typeof obj === 'object') {\n    if (obj._flags) {\n      for ( var type in obj._flags) {\n        if (obj._flags[type] > 0) {\n          this._flag(type, name);\n        }\n      }\n    }\n  }\n  return this;\n};\n\n/**\n * @private\n */\nClass.prototype.hitTest = function(hit) {\n  var width = this._pin._width;\n  var height = this._pin._height;\n  return hit.x >= 0 && hit.x <= width && hit.y >= 0 && hit.y <= height;\n};\n\nfunction _ensure(obj) {\n  if (obj && obj instanceof Class) {\n    return obj;\n  }\n  throw 'Invalid node: ' + obj;\n};\n\nmodule.exports = Class;\n","require('./util/event')(require('./core').prototype, function(obj, name, on) {\n  obj._flag(name, on);\n});\n","module.exports = function(prototype, callback) {\n\n  prototype._listeners = null;\n\n  prototype.on = prototype.listen = function(types, listener) {\n    if (!types || !types.length || typeof listener !== 'function') {\n      return this;\n    }\n    if (this._listeners === null) {\n      this._listeners = {};\n    }\n    var isarray = typeof types !== 'string' && typeof types.join === 'function';\n    if (types = (isarray ? types.join(' ') : types).match(/\\S+/g)) {\n      for (var i = 0; i < types.length; i++) {\n        var type = types[i];\n        this._listeners[type] = this._listeners[type] || [];\n        this._listeners[type].push(listener);\n        if (typeof callback === 'function') {\n          callback(this, type, true);\n        }\n      }\n    }\n    return this;\n  };\n\n  prototype.off = function(types, listener) {\n    if (!types || !types.length || typeof listener !== 'function') {\n      return this;\n    }\n    if (this._listeners === null) {\n      return this;\n    }\n    var isarray = typeof types !== 'string' && typeof types.join === 'function';\n    if (types = (isarray ? types.join(' ') : types).match(/\\S+/g)) {\n      for (var i = 0; i < types.length; i++) {\n        var type = types[i], all = this._listeners[type], index;\n        if (all && (index = all.indexOf(listener)) >= 0) {\n          all.splice(index, 1);\n          if (!all.length) {\n            delete this._listeners[type];\n          }\n          if (typeof callback === 'function') {\n            callback(this, type, false);\n          }\n        }\n      }\n    }\n    return this;\n  };\n\n  prototype.listeners = function(type) {\n    return this._listeners && this._listeners[type];\n  };\n\n  prototype.publish = function(name, args) {\n    var listeners = this.listeners(name);\n    if (!listeners || !listeners.length) {\n      return 0;\n    }\n    for (var l = 0; l < listeners.length; l++) {\n      listeners[l].apply(this, args);\n    }\n    return listeners.length;\n  };\n\n  prototype.trigger = function(name, args) {\n    this.publish(name, args);\n    return this;\n  };\n\n};\n","var Class = require('./core');\nrequire('./pin');\nrequire('./loop');\n\nvar stats = require('./util/stats');\nvar create = require('./util/create');\nvar extend = require('./util/extend');\n\nRoot._super = Class;\nRoot.prototype = create(Root._super.prototype);\n\nClass.root = function(request, render) {\n  return new Root(request, render);\n};\n\nfunction Root(request, render) {\n  Root._super.call(this);\n  this.label('Root');\n\n  var paused = true;\n  var stopped = true;\n\n  var self = this;\n  var lastTime = 0;\n  var loop = function(now) {\n    if (paused === true || stopped === true) {\n      return;\n    }\n\n    stats.tick = stats.node = stats.draw = 0;\n\n    var last = lastTime || now;\n    var elapsed = now - last;\n    lastTime = now;\n\n    var ticked = self._tick(elapsed, now, last);\n    if (self._mo_touch != self._ts_touch) {\n      self._mo_touch = self._ts_touch;\n      render(self);\n      request(loop);\n    } else if (ticked) {\n      request(loop);\n    } else {\n      paused = true;\n    }\n\n    stats.fps = elapsed ? 1000 / elapsed : 0;\n  };\n\n  this.start = function() {\n    stopped = false;\n    return this.resume();\n  };\n\n  this.resume = function() {\n    if (paused) {\n      this.publish('resume');\n      paused = false;\n      request(loop);\n    }\n    return this;\n  };\n\n  this.pause = function() {\n    if (!paused) {\n      this.publish('pause');\n    }\n    paused = true;\n    return this;\n  };\n\n  this.touch_root = this.touch;\n  this.touch = function() {\n    this.resume();\n    return this.touch_root();\n  };\n  this.stop = function() {\n    stopped = true;\n    return this;\n  };\n};\n\nRoot.prototype.background = function(color) {\n  // to be implemented by loaders\n  return this;\n};\n\nRoot.prototype.viewport = function(width, height, ratio) {\n  if (typeof width === 'undefined') {\n    return extend({}, this._viewport);\n  }\n  this._viewport = {\n    width : width,\n    height : height,\n    ratio : ratio || 1\n  };\n  this.viewbox();\n  var data = extend({}, this._viewport);\n  this.visit({\n    start : function(node) {\n      if (!node._flag('viewport')) {\n        return true;\n      }\n      node.publish('viewport', [ data ]);\n    }\n  });\n  return this;\n};\n\n// TODO: static/fixed viewbox\nRoot.prototype.viewbox = function(width, height, mode) {\n  if (typeof width === 'number' && typeof height === 'number') {\n    this._viewbox = {\n      width : width,\n      height : height,\n      mode : /^(in|out|in-pad|out-crop)$/.test(mode) ? mode : 'in-pad'\n    };\n  }\n\n  var box = this._viewbox;\n  var size = this._viewport;\n  if (size && box) {\n    this.pin({\n      width : box.width,\n      height : box.height\n    });\n    this.scaleTo(size.width, size.height, box.mode);\n  } else if (size) {\n    this.pin({\n      width : size.width,\n      height : size.height\n    });\n  }\n\n  return this;\n};\n","var Class = require('./core');\nvar Texture = require('./texture');\n\nClass.canvas = function(type, attributes, drawFn) {\n  if (typeof type === 'string') {\n    if (typeof attributes === 'object') {\n    } else {\n      if (typeof attributes === 'function') {\n        drawFn = attributes;\n      }\n      attributes = {};\n    }\n  } else {\n    if (typeof type === 'function') {\n      drawFn = type;\n    }\n    attributes = {};\n    type = '2d';\n  }\n\n  var canvas = document.createElement('canvas');\n  var context = canvas.getContext(type, attributes);\n  var texture = new Texture(canvas);\n\n  texture.context = function() {\n    return context;\n  };\n\n  texture.size = function(width, height, ratio) {\n    ratio = ratio || 1;\n    canvas.width = width * ratio;\n    canvas.height = height * ratio;\n    this.src(canvas, ratio);\n    return this;\n  };\n\n  texture.canvas = function(fn) {\n    if (typeof fn === 'function') {\n      fn.call(this, context);\n    } else if (typeof fn === 'undefined' && typeof drawFn === 'function') {\n      drawFn.call(this, context);\n    }\n    return this;\n  };\n\n  if (typeof drawFn === 'function') {\n    drawFn.call(texture, context);\n  }\n\n  return texture;\n};","var Class = require('./core');\nrequire('./pin');\nrequire('./loop');\n\nvar repeat = require('./util/repeat');\nvar create = require('./util/create');\n\nmodule.exports = Image;\n\nClass.image = function(image) {\n  var img = new Image();\n  image && img.image(image);\n  return img;\n};\n\nImage._super = Class;\nImage.prototype = create(Image._super.prototype);\n\nfunction Image() {\n  Image._super.call(this);\n  this.label('Image');\n  this._textures = [];\n  this._image = null;\n};\n\n/**\n * @deprecated Use image\n */\nImage.prototype.setImage = function(a, b, c) {\n  return this.image(a, b, c);\n};\n\nImage.prototype.image = function(image) {\n  this._image = Class.texture(image).one();\n  this.pin('width', this._image ? this._image.width : 0);\n  this.pin('height', this._image ? this._image.height : 0);\n  this._textures[0] = this._image.pipe();\n  this._textures.length = 1;\n  return this;\n};\n\nImage.prototype.tile = function(inner) {\n  this._repeat(false, inner);\n  return this;\n};\n\nImage.prototype.stretch = function(inner) {\n  this._repeat(true, inner);\n  return this;\n};\n\nImage.prototype._repeat = function(stretch, inner) {\n  var self = this;\n  this.untick(this._repeatTicker);\n  this.tick(this._repeatTicker = function() {\n    if (this._mo_stretch == this._pin._ts_transform) {\n      return;\n    }\n    this._mo_stretch = this._pin._ts_transform;\n    var width = this.pin('width');\n    var height = this.pin('height');\n    this._textures.length = repeat(this._image, width, height, stretch, inner,\n        insert);\n  });\n\n  function insert(i, sx, sy, sw, sh, dx, dy, dw, dh) {\n    var repeat = self._textures.length > i ? self._textures[i]\n        : self._textures[i] = self._image.pipe();\n    repeat.src(sx, sy, sw, sh);\n    repeat.dest(dx, dy, dw, dh);\n  }\n};\n","module.exports = function(img, owidth, oheight, stretch, inner, insert) {\n\n  var width = img.width;\n  var height = img.height;\n  var left = img.left;\n  var right = img.right;\n  var top = img.top;\n  var bottom = img.bottom;\n\n  left = typeof left === 'number' && left === left ? left : 0;\n  right = typeof right === 'number' && right === right ? right : 0;\n  top = typeof top === 'number' && top === top ? top : 0;\n  bottom = typeof bottom === 'number' && bottom === bottom ? bottom : 0;\n\n  width = width - left - right;\n  height = height - top - bottom;\n\n  if (!inner) {\n    owidth = Math.max(owidth - left - right, 0);\n    oheight = Math.max(oheight - top - bottom, 0);\n  }\n\n  var i = 0;\n\n  if (top > 0 && left > 0)\n    insert(i++, 0, 0, left, top, 0, 0, left, top);\n  if (bottom > 0 && left > 0)\n    insert(i++, 0, height + top, left, bottom, 0, oheight + top, left, bottom);\n  if (top > 0 && right > 0)\n    insert(i++, width + left, 0, right, top, owidth + left, 0, right, top);\n  if (bottom > 0 && right > 0)\n    insert(i++, width + left, height + top, right, bottom, owidth + left,\n        oheight + top, right, bottom);\n\n  if (stretch) {\n    if (top > 0)\n      insert(i++, left, 0, width, top, left, 0, owidth, top);\n    if (bottom > 0)\n      insert(i++, left, height + top, width, bottom, left, oheight + top,\n          owidth, bottom);\n    if (left > 0)\n      insert(i++, 0, top, left, height, 0, top, left, oheight);\n    if (right > 0)\n      insert(i++, width + left, top, right, height, owidth + left, top, right,\n          oheight);\n    // center\n    insert(i++, left, top, width, height, left, top, owidth, oheight);\n\n  } else { // tile\n    var l = left, r = owidth, w;\n    while (r > 0) {\n      w = Math.min(width, r), r -= width;\n      var t = top, b = oheight, h;\n      while (b > 0) {\n        h = Math.min(height, b), b -= height;\n        insert(i++, left, top, w, h, l, t, w, h);\n        if (r <= 0) {\n          if (left)\n            insert(i++, 0, top, left, h, 0, t, left, h);\n          if (right)\n            insert(i++, width + left, top, right, h, l + w, t, right, h);\n        }\n        t += h;\n      }\n      if (top)\n        insert(i++, left, 0, w, top, l, 0, w, top);\n      if (bottom)\n        insert(i++, left, height + top, w, bottom, l, t, w, bottom);\n      l += w;\n    }\n  }\n\n  return i;\n};","var Class = require('./core');\nrequire('./pin');\nrequire('./loop');\n\nvar create = require('./util/create');\nvar math = require('./util/math');\n\nClass.anim = function(frames, fps) {\n  var anim = new Anim();\n  anim.frames(frames).gotoFrame(0);\n  fps && anim.fps(fps);\n  return anim;\n};\n\nAnim._super = Class;\nAnim.prototype = create(Anim._super.prototype);\n\n// TODO: replace with atlas fps or texture time\nClass.Anim = {\n  FPS : 15\n};\n\nfunction Anim() {\n  Anim._super.call(this);\n  this.label('Anim');\n\n  this._textures = [];\n\n  this._fps = Class.Anim.FPS;\n  this._ft = 1000 / this._fps;\n\n  this._time = -1;\n  this._repeat = 0;\n\n  this._index = 0;\n  this._frames = [];\n\n  var lastTime = 0;\n  this.tick(function(t, now, last) {\n    if (this._time < 0 || this._frames.length <= 1) {\n      return;\n    }\n\n    // ignore old elapsed\n    var ignore = lastTime != last;\n    lastTime = now;\n    if (ignore) {\n      return true;\n    }\n\n    this._time += t;\n    if (this._time < this._ft) {\n      return true;\n    }\n    var n = this._time / this._ft | 0;\n    this._time -= n * this._ft;\n    this.moveFrame(n);\n    if (this._repeat > 0 && (this._repeat -= n) <= 0) {\n      this.stop();\n      this._callback && this._callback();\n      return false;\n    }\n    return true;\n  }, false);\n};\n\nAnim.prototype.fps = function(fps) {\n  if (typeof fps === 'undefined') {\n    return this._fps;\n  }\n  this._fps = fps > 0 ? fps : Class.Anim.FPS;\n  this._ft = 1000 / this._fps;\n  return this;\n};\n\n/**\n * @deprecated Use frames\n */\nAnim.prototype.setFrames = function(a, b, c) {\n  return this.frames(a, b, c);\n};\n\nAnim.prototype.frames = function(frames) {\n  this._index = 0;\n  this._frames = Class.texture(frames).array();\n  this.touch();\n  return this;\n};\n\nAnim.prototype.length = function() {\n  return this._frames ? this._frames.length : 0;\n};\n\nAnim.prototype.gotoFrame = function(frame, resize) {\n  this._index = math.rotate(frame, this._frames.length) | 0;\n  resize = resize || !this._textures[0];\n  this._textures[0] = this._frames[this._index];\n  if (resize) {\n    this.pin('width', this._textures[0].width);\n    this.pin('height', this._textures[0].height);\n  }\n  this.touch();\n  return this;\n};\n\nAnim.prototype.moveFrame = function(move) {\n  return this.gotoFrame(this._index + move);\n};\n\nAnim.prototype.repeat = function(repeat, callback) {\n  this._repeat = repeat * this._frames.length - 1;\n  this._callback = callback;\n  this.play();\n  return this;\n};\n\nAnim.prototype.play = function(frame) {\n  if (typeof frame !== 'undefined') {\n    this.gotoFrame(frame);\n    this._time = 0;\n  } else if (this._time < 0) {\n    this._time = 0;\n  }\n\n  this.touch();\n  return this;\n};\n\nAnim.prototype.stop = function(frame) {\n  this._time = -1;\n  if (typeof frame !== 'undefined') {\n    this.gotoFrame(frame);\n  }\n  return this;\n};\n","var Class = require('./core');\nrequire('./pin');\nrequire('./loop');\n\nvar create = require('./util/create');\nvar is = require('./util/is');\n\nClass.string = function(frames) {\n  return new Str().frames(frames);\n};\n\nStr._super = Class;\nStr.prototype = create(Str._super.prototype);\n\nfunction Str() {\n  Str._super.call(this);\n  this.label('String');\n  this._textures = [];\n};\n\n/**\n * @deprecated Use frames\n */\nStr.prototype.setFont = function(a, b, c) {\n  return this.frames(a, b, c);\n};\n\nStr.prototype.frames = function(frames) {\n  this._textures = [];\n  if (typeof frames == 'string') {\n    frames = Class.texture(frames);\n    this._item = function(value) {\n      return frames.one(value);\n    };\n  } else if (typeof frames === 'object') {\n    this._item = function(value) {\n      return frames[value];\n    };\n  } else if (typeof frames === 'function') {\n    this._item = frames;\n  }\n  return this;\n};\n\n/**\n * @deprecated Use value\n */\nStr.prototype.setValue = function(a, b, c) {\n  return this.value(a, b, c);\n};\n\nStr.prototype.value = function(value) {\n  if (typeof value === 'undefined') {\n    return this._value;\n  }\n  if (this._value === value) {\n    return this;\n  }\n  this._value = value;\n\n  if (value === null) {\n    value = '';\n  } else if (typeof value !== 'string' && !is.array(value)) {\n    value = value.toString();\n  }\n\n  this._spacing = this._spacing || 0;\n\n  var width = 0, height = 0;\n  for (var i = 0; i < value.length; i++) {\n    var image = this._textures[i] = this._item(value[i]);\n    width += i > 0 ? this._spacing : 0;\n    image.dest(width, 0);\n    width = width + image.width;\n    height = Math.max(height, image.height);\n  }\n  this.pin('width', width);\n  this.pin('height', height);\n  this._textures.length = value.length;\n  return this;\n};\n","var Class = require('./core');\nrequire('./pin');\nrequire('./loop');\n\nvar create = require('./util/create');\n\nClass.row = function(align) {\n  return Class.create().row(align).label('Row');\n};\n\nClass.prototype.row = function(align) {\n  this.sequence('row', align);\n  return this;\n};\n\nClass.column = function(align) {\n  return Class.create().column(align).label('Row');\n};\n\nClass.prototype.column = function(align) {\n  this.sequence('column', align);\n  return this;\n};\n\nClass.sequence = function(type, align) {\n  return Class.create().sequence(type, align).label('Sequence');\n};\n\nClass.prototype.sequence = function(type, align) {\n\n  this._padding = this._padding || 0;\n  this._spacing = this._spacing || 0;\n\n  this.untick(this._layoutTiker);\n  this.tick(this._layoutTiker = function() {\n    if (this._mo_seq == this._ts_touch) {\n      return;\n    }\n    this._mo_seq = this._ts_touch;\n\n    var alignChildren = (this._mo_seqAlign != this._ts_children);\n    this._mo_seqAlign = this._ts_children;\n\n    var width = 0, height = 0;\n\n    var child, next = this.first(true);\n    var first = true;\n    while (child = next) {\n      next = child.next(true);\n\n      child.matrix(true);\n      var w = child.pin('boxWidth');\n      var h = child.pin('boxHeight');\n\n      if (type == 'column') {\n        !first && (height += this._spacing);\n        child.pin('offsetY') != height && child.pin('offsetY', height);\n        width = Math.max(width, w);\n        height = height + h;\n        alignChildren && child.pin('alignX', align);\n\n      } else if (type == 'row') {\n        !first && (width += this._spacing);\n        child.pin('offsetX') != width && child.pin('offsetX', width);\n        width = width + w;\n        height = Math.max(height, h);\n        alignChildren && child.pin('alignY', align);\n      }\n      first = false;\n    }\n    width += 2 * this._padding;\n    height += 2 * this._padding;\n    this.pin('width') != width && this.pin('width', width);\n    this.pin('height') != height && this.pin('height', height);\n  });\n  return this;\n};\n\nClass.box = function() {\n  return Class.create().box().label('Box');\n};\n\nClass.prototype.box = function() {\n  this._padding = this._padding || 0;\n\n  this.untick(this._layoutTiker);\n  this.tick(this._layoutTiker = function() {\n    if (this._mo_box == this._ts_touch) {\n      return;\n    }\n    this._mo_box = this._ts_touch;\n\n    var width = 0, height = 0;\n    var child, next = this.first(true);\n    while (child = next) {\n      next = child.next(true);\n      child.matrix(true);\n      var w = child.pin('boxWidth');\n      var h = child.pin('boxHeight');\n      width = Math.max(width, w);\n      height = Math.max(height, h);\n    }\n    width += 2 * this._padding;\n    height += 2 * this._padding;\n    this.pin('width') != width && this.pin('width', width);\n    this.pin('height') != height && this.pin('height', height);\n  });\n  return this;\n};\n\nClass.layer = function() {\n  return Class.create().layer().label('Layer');\n};\n\nClass.prototype.layer = function() {\n\n  this.untick(this._layoutTiker);\n  this.tick(this._layoutTiker = function() {\n    var parent = this.parent();\n    if (parent) {\n      var width = parent.pin('width');\n      if (this.pin('width') != width) {\n        this.pin('width', width);\n      }\n      var height = parent.pin('height');\n      if (this.pin('height') != height) {\n        this.pin('height', height);\n      }\n    }\n  }, true);\n  return this;\n};\n\n// TODO: move padding to pin\nClass.prototype.padding = function(pad) {\n  this._padding = pad;\n  return this;\n};\n\nClass.prototype.spacing = function(space) {\n  this._spacing = space;\n  return this;\n};\n","var Easing = require('./easing');\nvar Class = require('../core');\nvar Pin = require('../pin');\n\nClass.prototype.tween = function(duration, delay, append) {\n  if (typeof duration !== 'number') {\n    append = duration, delay = 0, duration = 0;\n  } else if (typeof delay !== 'number') {\n    append = delay, delay = 0;\n  }\n\n  if (!this._tweens) {\n    this._tweens = [];\n    var ticktime = 0;\n    this.tick(function(elapsed, now, last) {\n      if (!this._tweens.length) {\n        return;\n      }\n\n      // ignore old elapsed\n      var ignore = ticktime != last;\n      ticktime = now;\n      if (ignore) {\n        return true;\n      }\n\n      var head = this._tweens[0];\n\n      var next = head.tick(this, elapsed, now, last);\n\n      if (next && head === this._tweens[0]) {\n        this._tweens.shift();\n      }\n\n      if (Array.isArray(next)) {\n        for (var i = 0; i < next.length; i++) {\n          try {\n            next[i].call(this);\n          } catch (e) {\n            console.log(e);\n          }\n        }\n      } else if (typeof next === 'object') {\n        this._tweens.unshift(next);\n      }\n\n      return true;\n    }, true);\n  }\n\n  this.touch();\n  if (!append) {\n    this._tweens.length = 0;\n  }\n  var tween = new Tween(this, duration, delay);\n  this._tweens.push(tween);\n  return tween;\n};\n\nfunction Tween(owner, duration, delay) {\n  this._end = {};\n  this._duration = duration || 400;\n  this._delay = delay || 0;\n\n  this._owner = owner;\n  this._time = 0;\n};\n\nTween.prototype.tick = function(node, elapsed, now, last) {\n  this._time += elapsed;\n\n  if (this._time < this._delay) {\n    return;\n  }\n\n  var time = this._time - this._delay;\n\n  if (!this._start) {\n    this._start = {};\n    for ( var key in this._end) {\n      this._start[key] = this._owner.pin(key);\n    }\n  }\n\n  var p, over;\n  if (time < this._duration) {\n    p = time / this._duration;\n    over = false;\n  } else {\n    p = 1;\n    over = true;\n  }\n\n  if (typeof this._easing == 'function') {\n    p = this._easing(p);\n  }\n\n  var q = 1 - p;\n\n  for ( var key in this._end) {\n    this._owner.pin(key, this._start[key] * q + this._end[key] * p);\n  }\n\n  if (over) {\n    var actions = [this._hide, this._remove, this._done];\n    actions = actions.filter(function( element ) {\n      return typeof element === 'function';\n    });\n    return this._next || actions;\n  }\n};\n\nTween.prototype.tween = function(duration, delay) {\n  return this._next = new Tween(this._owner, duration, delay);\n};\n\nTween.prototype.duration = function(duration) {\n  this._duration = duration;\n  return this;\n};\n\nTween.prototype.delay = function(delay) {\n  this._delay = delay;\n  return this;\n};\n\nTween.prototype.ease = function(easing) {\n  this._easing = Easing(easing);\n  return this;\n};\n\nTween.prototype.done = function(fn) {\n  this._done = fn;\n  return this;\n};\n\nTween.prototype.hide = function() {\n  this._hide = function() {\n    this.hide();\n  };\n  return this;\n};\n\nTween.prototype.remove = function() {\n  this._remove = function() {\n    this.remove();\n  };\n  return this;\n};\n\nTween.prototype.pin = function(a, b) {\n  if (typeof a === 'object') {\n    for ( var attr in a) {\n      pinning(this._owner, this._end, attr, a[attr]);\n    }\n  } else if (typeof b !== 'undefined') {\n    pinning(this._owner, this._end, a, b);\n  }\n  return this;\n};\n\nfunction pinning(node, map, key, value) {\n  if (typeof node.pin(key) === 'number') {\n    map[key] = value;\n  } else if (typeof node.pin(key + 'X') === 'number'\n      && typeof node.pin(key + 'Y') === 'number') {\n    map[key + 'X'] = value;\n    map[key + 'Y'] = value;\n  }\n}\n\nPin._add_shortcuts(Tween);\n\n/**\n * @deprecated Use .done(fn) instead.\n */\nTween.prototype.then = function(fn) {\n  this.done(fn);\n  return this;\n};\n\n/**\n * @deprecated NOOP\n */\nTween.prototype.clear = function(forward) {\n  return this;\n};\n\nmodule.exports = Tween;\n","function _identity(x) {\n  return x;\n};\nvar _cache = {};\nvar _modes = {};\nvar _easings = {};\n\nfunction Easing(token) {\n  if (typeof token === 'function') {\n    return token;\n  }\n  if (typeof token !== 'string') {\n    return _identity;\n  }\n  var fn = _cache[token];\n  if (fn) {\n    return fn;\n  }\n  var match = /^(\\w+)(-(in|out|in-out|out-in))?(\\((.*)\\))?$/i.exec(token);\n  if (!match || !match.length) {\n    return _identity;\n  }\n  var easing = _easings[match[1]];\n  var mode = _modes[match[3]];\n  var params = match[5];\n  if (easing && easing.fn) {\n    fn = easing.fn;\n  } else if (easing && easing.fc) {\n    fn = easing.fc.apply(easing.fc, params\n        && params.replace(/\\s+/, '').split(','));\n  } else {\n    fn = _identity;\n  }\n  if (mode) {\n    fn = mode.fn(fn);\n  }\n  // TODO: It can be a memory leak with different `params`.\n  _cache[token] = fn;\n  return fn;\n};\n\nEasing.add = function(data) {\n  // TODO: create a map of all { name-mode : data }\n  var names = (data.name || data.mode).split(/\\s+/);\n  for (var i = 0; i < names.length; i++) {\n    var name = names[i];\n    if (name) {\n      (data.name ? _easings : _modes)[name] = data;\n    }\n  }\n};\n\nEasing.add({\n  mode : 'in',\n  fn : function(f) {\n    return f;\n  }\n});\n\nEasing.add({\n  mode : 'out',\n  fn : function(f) {\n    return function(t) {\n      return 1 - f(1 - t);\n    };\n  }\n});\n\nEasing.add({\n  mode : 'in-out',\n  fn : function(f) {\n    return function(t) {\n      return (t < 0.5) ? (f(2 * t) / 2) : (1 - f(2 * (1 - t)) / 2);\n    };\n  }\n});\n\nEasing.add({\n  mode : 'out-in',\n  fn : function(f) {\n    return function(t) {\n      return (t < 0.5) ? (1 - f(2 * (1 - t)) / 2) : (f(2 * t) / 2);\n    };\n  }\n});\n\nEasing.add({\n  name : 'linear',\n  fn : function(t) {\n    return t;\n  }\n});\n\nEasing.add({\n  name : 'quad',\n  fn : function(t) {\n    return t * t;\n  }\n});\n\nEasing.add({\n  name : 'cubic',\n  fn : function(t) {\n    return t * t * t;\n  }\n});\n\nEasing.add({\n  name : 'quart',\n  fn : function(t) {\n    return t * t * t * t;\n  }\n});\n\nEasing.add({\n  name : 'quint',\n  fn : function(t) {\n    return t * t * t * t * t;\n  }\n});\n\nEasing.add({\n  name : 'sin sine',\n  fn : function(t) {\n    return 1 - Math.cos(t * Math.PI / 2);\n  }\n});\n\nEasing.add({\n  name : 'exp expo',\n  fn : function(t) {\n    return t == 0 ? 0 : Math.pow(2, 10 * (t - 1));\n  }\n});\n\nEasing.add({\n  name : 'circle circ',\n  fn : function(t) {\n    return 1 - Math.sqrt(1 - t * t);\n  }\n});\n\nEasing.add({\n  name : 'bounce',\n  fn : function(t) {\n    return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625\n        * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625\n        * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t\n        + .984375;\n  }\n});\n\nEasing.add({\n  name : 'poly',\n  fc : function(e) {\n    return function(t) {\n      return Math.pow(t, e);\n    };\n  }\n});\n\nEasing.add({\n  name : 'elastic',\n  fc : function(a, p) {\n    p = p || 0.45;\n    a = a || 1;\n    var s = p / (2 * Math.PI) * Math.asin(1 / a);\n    return function(t) {\n      return 1 + a * Math.pow(2, -10 * t)\n          * Math.sin((t - s) * (2 * Math.PI) / p);\n    };\n  }\n});\n\nEasing.add({\n  name : 'back',\n  fc : function(s) {\n    s = typeof s !== 'undefined' ? s : 1.70158;\n    return function(t) {\n      return t * t * ((s + 1) * t - s);\n    };\n  }\n});\n\nmodule.exports = Easing;\n","if (typeof DEBUG === 'undefined')\n  DEBUG = true;\n\nrequire('../core')._load(function(stage, elem) {\n  Mouse.subscribe(stage, elem);\n});\n\n// TODO: capture mouse\n\nMouse.CLICK = 'click';\nMouse.START = 'touchstart mousedown';\nMouse.MOVE = 'touchmove mousemove';\nMouse.END = 'touchend mouseup';\nMouse.CANCEL = 'touchcancel mousecancel';\n\nMouse.subscribe = function(stage, elem) {\n  if (stage.mouse) {\n    return;\n  }\n\n  stage.mouse = new Mouse(stage, elem);\n\n  // `click` events are synthesized from start/end events on same nodes\n  // `mousecancel` events are synthesized on blur or mouseup outside element\n\n  elem.addEventListener('touchstart', handleStart);\n  elem.addEventListener('touchend', handleEnd);\n  elem.addEventListener('touchmove', handleMove);\n  elem.addEventListener('touchcancel', handleCancel);\n\n  elem.addEventListener('mousedown', handleStart);\n  elem.addEventListener('mouseup', handleEnd);\n  elem.addEventListener('mousemove', handleMove);\n\n  document.addEventListener('mouseup', handleCancel);\n  window.addEventListener(\"blur\", handleCancel);\n\n  var clicklist = [], cancellist = [];\n\n  function handleStart(event) {\n    event.preventDefault();\n    stage.mouse.locate(event);\n    // DEBUG && console.log('Mouse Start: ' + event.type + ' ' + mouse);\n    stage.mouse.publish(event.type, event);\n\n    stage.mouse.lookup('click', clicklist);\n    stage.mouse.lookup('mousecancel', cancellist);\n  }\n\n  function handleMove(event) {\n    event.preventDefault();\n    stage.mouse.locate(event);\n    stage.mouse.publish(event.type, event);\n  }\n\n  function handleEnd(event) {\n    event.preventDefault();\n    // up/end location is not available, last one is used instead\n    // DEBUG && console.log('Mouse End: ' + event.type + ' ' + mouse);\n    stage.mouse.publish(event.type, event);\n\n    if (clicklist.length) {\n      // DEBUG && console.log('Mouse Click: ' + clicklist.length);\n      stage.mouse.publish('click', event, clicklist);\n    }\n    cancellist.length = 0;\n  }\n\n  function handleCancel(event) {\n    if (cancellist.length) {\n      // DEBUG && console.log('Mouse Cancel: ' + event.type);\n      stage.mouse.publish('mousecancel', event, cancellist);\n    }\n    clicklist.length = 0;\n  }\n};\n\nfunction Mouse(stage, elem) {\n  if (!(this instanceof Mouse)) {\n    // old-style mouse subscription\n    return;\n  }\n\n  var ratio = stage.viewport().ratio || 1;\n\n  stage.on('viewport', function(size) {\n    ratio = size.ratio || ratio;\n  });\n\n  this.x = 0;\n  this.y = 0;\n  this.toString = function() {\n    return (this.x | 0) + 'x' + (this.y | 0);\n  };\n  this.locate = function(event) {\n    locateElevent(elem, event, this);\n    this.x *= ratio;\n    this.y *= ratio;\n  };\n  this.lookup = function(type, collect) {\n    this.type = type;\n    this.root = stage;\n    this.event = null;\n    collect.length = 0;\n    this.collect = collect;\n\n    this.root.visit(this.visitor, this);\n  };\n  this.publish = function(type, event, targets) {\n    this.type = type;\n    this.root = stage;\n    this.event = event;\n    this.collect = false;\n    this.timeStamp = Date.now();\n\n    if (type !== 'mousemove' && type !== 'touchmove') {\n      DEBUG && console.log(this.type + ' ' + this);\n    }\n\n    if (targets) {\n      while (targets.length)\n        if (this.visitor.end(targets.shift(), this))\n          break;\n      targets.length = 0;\n    } else {\n      this.root.visit(this.visitor, this);\n    }\n  };\n  this.visitor = {\n    reverse : true,\n    visible : true,\n    start : function(node, mouse) {\n      return !node._flag(mouse.type);\n    },\n    end : function(node, mouse) {\n      // mouse: event/collect, type, root\n      rel.raw = mouse.event;\n      rel.type = mouse.type;\n      rel.timeStamp = mouse.timeStamp;\n      rel.abs.x = mouse.x;\n      rel.abs.y = mouse.y;\n\n      var listeners = node.listeners(mouse.type);\n      if (!listeners) {\n        return;\n      }\n      node.matrix().inverse().map(mouse, rel);\n      if (!(node === mouse.root || node.attr('spy') || node.hitTest(rel))) {\n        return;\n      }\n      if (mouse.collect) {\n        mouse.collect.push(node);\n      }\n      if (mouse.event) {\n        var cancel = false;\n        for (var l = 0; l < listeners.length; l++) {\n          cancel = listeners[l].call(node, rel) ? true : cancel;\n        }\n        return cancel;\n      }\n    }\n  };\n};\n\n// TODO: define per mouse object with get-only x and y\nvar rel = {}, abs = {};\n\ndefineValue(rel, 'clone', function(obj) {\n  obj = obj || {}, obj.x = this.x, obj.y = this.y;\n  return obj;\n});\ndefineValue(rel, 'toString', function() {\n  return (this.x | 0) + 'x' + (this.y | 0) + ' (' + this.abs + ')';\n});\ndefineValue(rel, 'abs', abs);\ndefineValue(abs, 'clone', function(obj) {\n  obj = obj || {}, obj.x = this.x, obj.y = this.y;\n  return obj;\n});\ndefineValue(abs, 'toString', function() {\n  return (this.x | 0) + 'x' + (this.y | 0);\n});\n\nfunction defineValue(obj, name, value) {\n  Object.defineProperty(obj, name, {\n    value : value\n  });\n}\n\nfunction locateElevent(el, ev, loc) {\n  // pageX/Y if available?\n  if (ev.touches && ev.touches.length) {\n    loc.x = ev.touches[0].clientX;\n    loc.y = ev.touches[0].clientY;\n  } else {\n    loc.x = ev.clientX;\n    loc.y = ev.clientY;\n  }\n  var rect = el.getBoundingClientRect();\n  loc.x -= rect.left;\n  loc.y -= rect.top;\n  loc.x -= el.clientLeft | 0;\n  loc.y -= el.clientTop | 0;\n  return loc;\n};\n\nmodule.exports = Mouse;\n","module.exports = require('../lib/');\n\nmodule.exports.internal = {};\n\nrequire('../lib/canvas');\nmodule.exports.internal.Image = require('../lib/image');\nrequire('../lib/anim');\nrequire('../lib/str');\nrequire('../lib/layout');\nrequire('../lib/addon/tween');\nmodule.exports.Mouse = require('../lib/addon/mouse');\nmodule.exports.Math = require('../lib/util/math');\nmodule.exports._extend = require('../lib/util/extend');\nmodule.exports._create = require('../lib/util/create');\n\nrequire('../lib/loader/cordova');","/**\n * Cordova/PhoneGap loader with FastContext support.\n */\n\nif (typeof DEBUG === 'undefined')\n  DEBUG = true;\n\nvar Class = require('../core');\n\nvar once = require('../util/once');\n\nif (typeof FastContext === 'undefined') {\n  FastContext = window.FastContext;\n}\n\nClass._supported = (function() {\n  var elem = document.createElement('canvas');\n  return (elem.getContext && elem.getContext('2d')) ? true : false;\n})();\n\nwindow.addEventListener('load', function() {\n  DEBUG && console.log('On load.');\n\n  var start = once(function(msg) {\n    DEBUG && msg && console.log('Started on ' + msg);\n    if (Class._supported) {\n      Class.start();\n    }\n    // TODO if not supported\n  });\n\n  // setTimeout(function() {\n  // start('timeout');\n  // }, 3000);\n\n  document.addEventListener('click', function() {\n    start('click');\n  }, false);\n\n  document.addEventListener('mousemove', function() {\n    start('mousemove');\n  }, false);\n\n  document.addEventListener('deviceready', function() {\n    start('deviceready');\n  }, false);\n\n  document.addEventListener('pause', function() {\n    Class.pause();\n  }, false);\n\n  document.addEventListener('resume', function() {\n    Class.resume();\n  }, false);\n}, false);\n\nClass.config({\n  'app-loader' : AppLoader,\n  'image-loader' : ImageLoader\n});\n\nfunction AppLoader(app, configs) {\n  configs = configs || {};\n  var canvas = configs.canvas, context = null, full = false;\n  var width = 0, height = 0, ratio = 1;\n\n  if (typeof canvas === 'string') {\n    canvas = document.getElementById(canvas);\n  }\n\n  if (!canvas) {\n    canvas = document.getElementById('cutjs')\n        || document.getElementById('stage');\n  }\n\n  if (!canvas) {\n    full = true;\n    DEBUG && console.log('Creating Canvas...');\n    canvas = document.createElement('canvas');\n    canvas.style.position = 'absolute';\n    canvas.style.top = '0';\n    canvas.style.left = '0';\n\n    var body = document.body;\n    body.insertBefore(canvas, body.firstChild);\n  }\n\n  context = canvas.getContext('2d', {\n    fastcontext : true\n  });\n\n  context.isFast = !!context.isFast;\n\n  full = full || context.isFast;\n\n  DEBUG && console.log('FastContext: ' + context.isFast);\n\n  var devicePixelRatio = window.devicePixelRatio || 1;\n  var backingStoreRatio = context.webkitBackingStorePixelRatio\n      || context.mozBackingStorePixelRatio || context.msBackingStorePixelRatio\n      || context.oBackingStorePixelRatio || context.backingStorePixelRatio || 1;\n  ratio = devicePixelRatio / backingStoreRatio;\n\n  var requestAnimationFrame = window.requestAnimationFrame\n      || window.msRequestAnimationFrame || window.mozRequestAnimationFrame\n      || window.webkitRequestAnimationFrame || window.oRequestAnimationFrame\n      || function(callback) {\n        return window.setTimeout(callback, 1000 / 60);\n      };\n\n  DEBUG && console.log('Creating stage...');\n  var root = Class.root(requestAnimationFrame, render);\n\n  function render() {\n    if (context.isFast) {\n      context.clear();\n      context.setTransform(1, 0, 0, 1, 0, 0);\n    } else {\n      context.setTransform(1, 0, 0, 1, 0, 0);\n      context.clearRect(0, 0, width, height);\n    }\n    root.render(context);\n  }\n\n  root.background = function(color) {\n    if (context.isFast) {\n      context.setBackgroundColor && context.setBackgroundColor(color);\n    } else {\n      canvas.style.backgroundColor = color;\n    }\n    return this;\n  };\n\n  app(root, canvas);\n\n  resize();\n  window.addEventListener('resize', resize, false);\n  window.addEventListener('orientationchange', resize, false);\n\n  function resize() {\n\n    if (full) {\n      // screen.availWidth/Height?\n      width = (window.innerWidth > 0 ? window.innerWidth : screen.width);\n      height = (window.innerHeight > 0 ? window.innerHeight : screen.height);\n\n      canvas.style.width = width + 'px';\n      canvas.style.height = height + 'px';\n\n    } else {\n      width = canvas.clientWidth;\n      height = canvas.clientHeight;\n    }\n\n    width *= ratio;\n    height *= ratio;\n\n    if (canvas.width === width && canvas.height === height) {\n      return;\n    }\n\n    canvas.width = width;\n    canvas.height = height;\n\n    DEBUG && console.log('Resize: ' + width + ' x ' + height + ' / ' + ratio);\n\n    root.viewport(width, height, ratio);\n\n    render();\n  }\n}\n\nfunction ImageLoader(src, success, error) {\n  DEBUG && console.log('Loading image: ' + src);\n  var image;\n  if (FastContext) {\n    image = FastContext.createImage(src, loaded, error);\n  } else {\n    image = new Image();\n    image.onload = loaded;\n    image.onerror = error;\n    image.src = src;\n  }\n  function loaded() {\n    success(image);\n  }\n}\n","module.exports = function(fn, ctx) {\n  var called = false;\n  return function() {\n    if (!called) {\n      called = true;\n      fn.apply(ctx, arguments);\n    }\n  };\n};"],"sourceRoot":""}